{"list":["9.0.1.1","9.0.1.2","9.1.1.1","9.1.1.2","9.1.1.3","9.1.1.4","9.1.1.5","9.1.1.6","9.1.2.1","9.1.2.2","9.1.2.3","9.1.2.4","9.1.2.5","9.1.2.6","9.1.3.1","9.1.3.2","9.2.1.1","9.2.1.2","9.2.1.3","9.2.1.4","9.2.2.1","9.2.2.2","9.2.2.3","9.2.2.4","9.2.2.5","9.2.2.6","9.2.3.1","9.2.3.2","9.2.3.3","9.2.3.4","9.2.3.5","9.2.3.6","9.2.3.7","9.2.4.1","9.2.4.2","9.2.4.3","9.2.4.4","9.2.5.1","9.2.5.2","9.2.5.3","9.3.1.1","9.3.1.2","9.3.1.3","9.3.1.4","9.3.1.5","9.4.1.1","9.4.1.2","9.4.1.3"],"map":{"0":[16,18,20,21,26,27,29,35,38,41,42],"1":[2,5,6,11,16,17,18,21,22,23,24,25,26,27,28,29,31,32,33,34,35,37,38,40,41,42,44],"2":[2,16,17,18,21,22,24,25,26,27,28,29,31,32,33,35,37,40,41,42,44],"3":[16,17,21,22,23,25,26,27,28,31,32,35,40,42,44],"4":[12,16,17,21,22,27,28,40,42],"5":[16,17,21,28],"6":[17,22,28],"8":[38],"9":[0,47],"10":[4,5,6,8,16,17,20,21,22,28,35,40,41],"11":[20,21,22],"16":[21,26,27,29,38,41,42],"20":[37],"24":[20,23,42],"36":[37],"40":[38],"43":[0],"64":[38],"65":[8,11,26],"80":[33,34,35],"90":[37],"100":[8],"128":[37],"165":[4,5,6,8,16,17,20,21,22,26,27,28,29,34,35,40,41],"168":[4,5,6,16,17,20,21,22,26,27,28,29,34,35,40,41,42],"192":[4,5,6,16,17,20,21,22,27,28,29,34,35,40,41,42],"200":[4,5,6,8,20,21,22,26,27,28,29,34,35,40,41],"201":[4,5,6,16,17,28,40,41],"209":[4,5,6,16,17,20,21,22,26,27,28,29,34,35,40,41],"225":[28,35],"226":[6,20,21,22,26,40],"227":[22],"240":[20,21,26],"254":[16,17,22,34,35],"340":[37],"420":[11],"535":[11],"536":[8,26],"1023":[11],"1024":[11],"1331":[10],"1445":[11,28],"1918":[0,2,14,20,33,37,38,47],"1981":[0],"2000":[2],"2011":[37],"3513":[38],"3879":[38],"4000":[26],"4193":[38],"5902":[37],"8080":[33,35],"第":[0,24,25,31,32,44,47],"章：ipv4":[0,47],"nat":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,33,35,37,38,39,40,41,42,43,44,45,47],"互联网上的所有公共":[0],"ipv4":[0,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17,19,20,21,22,26,27,28,29,33,34,35,37,38,39,40,41,47],"地址必须到地区互联网注册管理机构":[0],"rir":[0],"进行注册。组织可租用服务提供商的公共地址。公有":[0],"ip":[0,10,18,19,21,23,29,35,40,41,42],"地址的注册拥有者可将该地址分配给网络设备。":[0],"亿个地址是最大理论值，ipv4":[0],"地址空间很有限。当":[0],"bob":[0],"kahn":[0],"和":[0,8,10,11,12,20,21,22,27,28,39,40,42,47],"vint":[0],"cerf":[0],"在":[0,4,19,37,38],"年首次开发":[0],"tcp":[0,10,12,15,26,28,35],"协议簇（包括":[0],"ipv4）时，他们从未想象过互联网会如何变化。当时，个人计算机主要是为了满足爱好者的好奇心，而万维网还是在十多年以后才出现的。":[0],"随着个人计算机的激增和万维网的出现，很快":[0],"亿个":[0],"地址就不够用了。长期解决方案是":[0],"ipv6，但是现在迫切需要更快的地址耗尽解决方案。就短期而言，ietf":[0],"实施了几种解决方案，包括网络地址转换":[0],"rfc":[0,2,14,20,33,37,38,47],"私有":[0,33,37],"地址":[0,5,16,22,26,27,28,29,34,35],"本章讨论":[0],"与私有地址空间一起如何用于节省并更有效地使用":[0],"地址，从而让各种规模的网络访问互联网。本章包括：":[0],"特性、术语和一般操作":[0,47],"不同类型的":[0,47],"nat，包括静态":[0,47],"nat，动态":[0,47],"和过载的":[0],"优势和缺点":[0,47],"配置、验证和分析静态":[0,47],"nat、动态":[0],"过载":[0],"如何使用端口转发从互联网访问内部设备":[0,47],"使用":[0,15,21,27,35,38,40,41,47],"show":[0,18,23,40,42,47],"debug":[0,40,41,47],"命令对":[0,47],"进行故障排除":[0,47],"如何使用":[0],"for":[0],"ipv6":[0,2,37,38,39,47],"地址和":[0,14,37],"地址之间进行转换":[0],"概念":[1],"场景":[1,36,45,46],"您为一个大型高校或学校系统工作。":[1],"由于您是网络管理员，许多教授、行政人员和其他网络管理员需要您提供日常网络协助。他们会在一天的任何工作时间给您打电话，而且，由于电话次数较多，您无法完成日常网络管理任务。":[1],"您需要找到一种方法限制电话接听时间和拨号人员。您还需要屏蔽电话号码，这样当您给某人打电话时，接听电话的人看到的是另一个号码。":[1],"这一场景描述了大多数中小型企业都会碰到的一个非常常见的问题。要了解有关数字化世界如何处理这些类型工作日中断的更多信息，请访问位于":[1],"此处的":[1],"网络地址转换工作原理":[1],"。":[1,22,37],"使用该活动附带的":[1],"pdf":[1],"进一步思考所谓的":[1],"进程如何解决此场景的挑战。":[1],"课堂练习":[1,45],"概念说明":[1],"私有地址空间":[2],"公有":[2],"地址不足以为每台设备分配一个唯一地址来进行互联网连接。通常使用":[2],"中定义的私有":[2],"地址来实施网络。图":[2],"显示了":[2,40,41],"中所包含的地址范围。很可能为您用来观看本课程的计算机分配的就是一个私有地址。":[2],"这些私有地址可在企业或站点内使用，允许设备进行本地通信。但是，由于这些地址没有标识任何一个公司或企业，因此私有":[2],"地址不能通过互联网路由。为了使具有私有":[2],"地址的设备能够访问本地网络之外的设备和资源，必须首先将私有地址转换为公有地址。":[2],"如图":[2,28,29,42],"所示，nat":[2],"提供了私有地址到公有地址的转换。这使具有私有":[2],"地址的设备能够访问其私有网络之外的资源，例如在互联网上找到的资源。nat":[2],"与私有":[2],"地址相结合，变为一个用于节约公有":[2],"地址的有效方法。单个公有":[2],"地址可以由数百甚至数千台设备共享，而为每台设备配置一个唯一的私有":[2],"地址。":[2,3,4,8,9,11,16,27,29,41],"如果没有":[2],"nat，则":[2],"地址空间耗尽问题可能早在":[2],"年之前就会出现。但是，nat":[2],"也有一些限制，这将在本章后续部分探讨。为了应对":[2],"地址空间耗尽问题以及":[2],"的局限性，最终需要向":[2],"过渡。":[2],"何谓":[3],"nat？":[3,37],"有很多作用，但其主要作用是节省了公有":[3],"地址。它通过允许网络在内部使用私有":[3],"地址，而只在需要时提供到公有地址的转换，从而实现这一作用。nat":[3],"还能在一定程度上增加网络的私密性和安全性，因为它对外部网络隐藏了内部":[3],"可以为启用":[3],"的路由器配置一个或多个有效的公有":[3],"地址。这些公有地址称为":[3],"地址池。当内部设备将流量发送到网络外部时，启用":[3],"的路由器会将设备的内部":[3],"地址转换为":[3],"池中的一个公有地址。对外部设备而言，所有进出网络的流量好像都有一个取自所提供地址池中的公有":[3],"路由器通常工作在末节网络边界。末节网络是一个与其相邻网络具有单个连接的网络，而且单进单出。在图中的示例中，r2":[3],"为边界路由器。对":[3],"isp":[3,10,14,26,27,34,47],"来说，r2":[3],"构成末节网络。":[3],"当末节网络内的设备想要与其网络外部的设备通信时，会将数据包转发到边界路由器。边界路由器会执行":[3],"过程，将设备的内部私有地址转换为公有的外部可路由地址。":[3],"注：与":[3],"的连接可能使用私有地址或在客户之间共享的公有地址。出于学习本章的目的，这里显示一个公有地址。":[3],"术语":[4,7],"术语中，内部网络是指需要经过转换的网络地址集。外部网络指所有其他网络。":[4],"当使用":[4],"时，根据地址是在私有网络上还是在公有网络（互联网）上，以及流量是传入还是传出，不同的":[4],"地址有不同的称谓。":[4],"包括四类地址：":[4],"内部本地地址":[4,5],"内部全局地址":[4,5],"外部本地地址":[4,5],"外部全局地址":[4,5],"在决定使用哪种地址时，重要的是要记住":[4],"术语始终是从具有转换后地址的设备的角度来应用的：":[4],"内部地址":[4],"经过":[4],"转换的设备的地址。":[4],"外部地址":[4],"目标设备的地址。":[4],"关于地址，nat":[4],"还会使用本地或全局的概念：":[4],"本地地址":[4],"本地地址是在网络内部出现的任何地址。":[4],"全局地址":[4],"全局地址是在网络外部出现的任何地址。":[4],"图中，pc1":[4],"具有内部本地地址":[4],"10。从":[4],"pc1":[4,5,6,22,28,42],"的角度来讲，web":[4],"服务器具有外部地址":[4],"1。当数据包从":[4],"发送到":[4],"web":[4,5,6,8,10,16,17,18,22,28,29,33,34,35],"服务器的全局地址时，pc1":[4],"的内部本地地址将转换为":[4],"226（内部全局地址）。通常不会转换外部设备的地址，因为该地址一般是公有":[4],"注意，pc1":[4],"具有不同的本地和全局地址，而":[4],"服务器对于本地和全局地址都使用相同的公有":[4],"地址。从":[4],"服务器的角度来讲，源自":[4],"的流量好像来自":[4],"226（内部全局地址）。":[4],"路由器（图中的":[4],"r2）是内部和外部网络之间以及本地地址和全局地址之间的分界点。":[4],"术语（续）":[5],"将术语":[5],"内部和外部":[5],"与术语":[5],"本地和全局":[5],"组合起来表示特定地址":[5],"图中，已将路由器":[5],"r2":[5,6,10,16,17,18,21,22,26,27,28,29,35,41],"配置为提供":[5],"nat。它具有可以为内部主机分配的公有地址池。":[5],"从网络内部看到的源地址。图中，ipv4":[5],"分配给了":[5],"pc1。这是":[5],"的内部本地地址。":[5],"从外部网络看到的源地址。图中，当流量从":[5],"发送到位于":[5],"的":[5,6,16,22,26,27,28,34,37,39,47],"服务器时，r2":[5],"会将内部本地地址转换为内部全局地址。在本例中，r2":[5],"将":[5,28],"源地址从":[5],"转变成":[5],"226。使用":[5],"术语就是，内部本地地址":[5],"将转换为内部全局地址":[5],"226。":[5,41],"从外部网络看到的目标地址。它是分配给互联网上的主机的全局可路由":[5],"地址。例如，web":[5],"服务器的可达":[5],"地址为":[5,22,34,35],"1。大多数情况下，外部本地地址和外部全局地址是相同的。":[5],"从网络内部看到的目标地址。在本示例中，pc1":[5],"将流量发送到":[5],"服务器上。虽然不常见，但该地址也可能与目标设备的全局可路由地址不同。":[5],"图中显示了如何为从内部":[5],"pc":[5,28],"通过启用":[5],"的路由器发送到外部":[5],"服务器的流量分配地址。还显示了如何对返回的流量进行初步的地址分配和转换。":[5],"注：外部本地地址的使用超出了本课程的范围。":[5],"如何工作":[6],"在本示例中，具有私有地址":[6],"想要与具有公有地址":[6],"的外部":[6],"服务器通信。":[6],"点击图中的":[6,10,11],"播放":[6,10,11],"按钮播放动画。":[6],"发送了一个目标地址为":[6],"服务器的数据包。数据包由":[6],"r1":[6,20],"转发到":[6],"r2。":[6,28],"当数据包到达":[6],"r2（网络中启用":[6],"的路由器）时，r2":[6],"会读取数据包的源":[6],"地址，以确定数据包是否符合规定的转换标准。":[6],"在本例中，源":[6],"地址确实符合标准，将其从":[6],"10（内部本地地址）转换为":[6],"226（内部全局地址）。r2":[6],"将此本地与全局地址映射关系添加到":[6],"表中。":[6],"将具有转换后的源地址的数据包发送到目的地。":[6],"服务器以一个目标地址为":[6],"的内部全局地址（209":[6,8],"226）的数据包做出响应。":[6],"将收到这个目标地址为":[6],"的数据包。r2":[6],"会检查":[6],"表，找出有关此映射的条目。r2":[6],"使用此信息，将内部全局地址（209":[6],"226）转换为内部本地地址（192":[6],"10），然后将数据包转发到":[6],"pc1。":[6,22,28],"练习":[7,30],"确定":[7],"此处输入故事板文本":[7,30],"静态":[8,16,20],"转换有三种类型：":[8],"静态地址转换（静态":[8],"nat）":[8],"本地地址和全局地址之间的一对一地址映射。":[8],"动态地址转换（动态":[8],"本地地址和全局地址之间的多对多地址映射。转换在可用的基础上进行：例如，如果有":[8],"个内部本地地址和":[8],"个内部全局地址，则任何时候都只能转换":[8],"个内部本地地址中的":[8],"个地址。动态":[8],"的这种限制使得它在用于生产网络时没有端口地址转换那么实用。":[8],"端口地址转换":[8,10],"pat":[8,10,11,12,26,27,28,29,31,32,40,47],"本地地址和全局地址之间的多对一地址映射。此方法也称为过载（nat":[8],"过载）。例如，如果有":[8],"个内部本地地址以及":[8],"个内部全局地址，pat":[8],"使用端口作为附加参数来提供乘数效应，从而支持重复使用":[8],"个内部全局地址中的任何一个地址，重复次数高达":[8],"次（这取决于通信流是基于":[8],"udp、tcp":[8],"还是":[8],"icmp）。":[8],"使用本地地址和全局地址的一对一映射。这些映射由网络管理员进行配置，并保持不变。":[8],"在图中，r2":[8],"上配置了":[8],"svr1、pc2":[8],"pc3":[8],"的内部本地地址的静态映射。当这些设备向互联网发送流量时，它们的内部本地地址将转换为已配置的内部全局地址。对外部网络而言，这些设备具有公有":[8],"对于必须具有可从互联网访问的一致地址的":[8],"服务器或设备特别有用。而且对于必须支持授权人员离线访问而不支持互联网上的普通大众访问的设备也很有用。例如，来自":[8],"pc4":[8],"的网络管理员可以使用":[8],"ssh":[8,46],"连接到":[8],"svr1":[8,28,42],"226）。r2":[8],"将此内部全局地址转换为内部本地地址，并将管理员的会话连接到":[8],"svr1。":[8,28],"为了满足所有同时发生的用户会话需要，静态":[8],"要求有足够的公有地址可用。":[8,9],"动态":[9,20],"使用公有地址池，并以先到先得的原则分配这些地址。内部设备请求访问外部网络时，动态":[9],"分配该池中的可用公共":[9],"图中，pc3":[9],"已经使用了动态":[9],"池中的第一个可用地址访问互联网。而其他地址仍可供使用。与静态":[9],"类似，为了满足所有同时发生的用户会话需要，动态":[9],"（也称为":[10],"过载），将多个私有":[10],"地址映射到单个私有":[10],"地址或几个地址。大多数家用路由器就是这样工作的。您的":[10],"分配一个地址给您的路由器，但是您的多名家庭成员可以同时上网冲浪。这是":[10],"的最常用方式。":[10],"可以将多个地址映射到一个或少数几个地址，因为每个私有地址也会用端口号加以跟踪。当设备发起":[10],"会话时，它生成一个":[10],"或":[10,11,12,15,21,26,35],"udp":[10,12,15,26,35],"源端口值或专门为":[10],"icmp":[10],"分配的查询":[10],"id，用来唯一标识会话。当":[10],"路由器收到来自客户端的数据包时，将使用其源端口号来唯一确定特定的":[10],"转换。":[10,16,18,35,42],"利用互联网上的服务器确保设备对每个会话使用不同的":[10],"端口号。当服务器返回响应时，源端口号（在回程中变成目标端口号）决定路由器将数据包转发到哪个设备。pat":[10],"过程还验证传入数据包是请求数据包，因此在一定程度上提高了会话的安全性。":[10],"暂停":[10],"按钮控制动画播放。":[10],"动画演示了":[10],"流程。pat":[10],"会将唯一的源端口号添加到内部全局地址上来区分不同的转换。":[10],"当":[10,40],"处理各数据包时，它使用端口号（本例中为":[10],"1555）来识别发起数据包的设备。源地址":[10],"sa":[10],"为内部本地地址加上":[10],"分配的端口号。目标地址":[10],"da":[10],"为外部本地地址加上服务的端口号。在本示例中，http":[10],"服务端口为":[10],"80。":[10,33,34],"对于源地址，r2":[10],"会将内部本地地址转换为内部全局地址，并添加端口号。目标地址未做更改，但此时称为外部全局":[10],"地址。当":[10],"服务器做出回复时，路径正好相反。":[10],"下一可用端口":[11],"在上述示例中，启用":[11],"的路由器上客户端的端口号（1331":[11],"1555）没有改变。这种情形不太常见，因为这些端口号很有可能已被其他正在进行的会话所使用。":[11],"会尝试保留原始的源端口。但是，如果原始的源端口已被使用，则":[11],"会从相应端口组（0":[11],"511、512":[11],"65535）的开头开始，分配第一个可用端口号。如果没有其他可用端口，而地址池中的外部地址多于一个，则":[11],"会进入下一地址并尝试重新分配原始的源端口。这一过程会一直持续，直到不再有可用端口或外部":[11],"按钮，观看":[11],"的工作原理。在本示例中，pat":[11],"已经将下一个可用端口":[11],"分配给第二个主机地址。":[11],"在动画中，主机选择了相同端口号":[11],"1444。这对于内部地址是可以接受的，因为主机具有唯一的私有":[11],"地址。但是，在":[11],"路由器上，必须更改端口号；否则，来自两个不同主机的数据包将使用相同的源地址离开":[11],"r2。此示例假设在":[11],"024":[11],"范围内的前":[11],"个端口已经在使用，因此，使用下一个可用的端口号":[11],"1445。":[11,28],"比较":[12],"总结":[12],"之间的差异将有助于您理解这两者。":[12],"如图所示，nat":[12],"在一对一的基础上进行私有":[12],"地址和公有":[12],"地址之间的":[12],"地址转换。但是，pat":[12],"会同时修改地址和端口号。":[12],"通过参考公有网络的主机给出的传入源":[12],"地址，nat":[12],"将传入数据包转发至其内部目的地。利用":[12],"pat，一般只需一个或极少的几个公有":[12],"地址。通过参考":[12],"路由器中的一个表，将来自公有网络的传入数据包路由到其私有网络中的目的地。此表会跟踪公有与私有端口对。这称为连接跟踪。":[12],"不包含第":[12],"层数据段的数据包":[12],"如果":[12],"数据包传送的是数据而不是":[12],"数据段会怎么样？这些数据包将不包含第":[12],"层端口号。pat":[12],"可以转换":[12],"承载的大多数常用协议，这些协议不会将":[12],"用作传输层协议。其中最常见的一种就是":[12],"icmpv4。对于每种类型的协议，pat":[12],"会以不同方式进行处理。例如，icmpv4":[12],"查询消息、响应请求和响应应答会包含一个查询":[12],"id。icmpv4":[12],"使用查询":[12],"id":[12,38],"来识别响应请求及其相应的响应应答。每发送一个响应请求，查询":[12],"都会增加。pat":[12],"将会使用查询":[12],"而不是第":[12],"层端口号。":[12],"注：其他":[12],"icmpv4":[12],"消息不使用查询":[12],"id。对于这些消息以及其他不使用":[12],"端口号的协议，情况有所不同，不在本课程的讨论范围之内。":[12],"packet":[13,19,24,31,34,36,43,46],"tracer":[13,19,24,31,34,36,43,46],"调查":[13],"操作":[13,20],"您知道，当帧通过网络传输时，mac":[13],"地址会发生更改。但是当数据包由配置了":[13],"的设备转发时，ipv4":[13],"地址也会改变。在本练习中，我们将了解":[13],"地址在":[13],"过程中的变化。":[13],"操作说明":[13],"pka":[13,19,24,31,36,43,46],"的优势":[14],"有许多优点，包括：":[14],"允许对内联网实行私有编址，从而维护合法注册的公有编址方案。nat":[14],"通过应用程序端口级别的多路复用节省了地址。利用":[14],"过载，对于所有外部通信，内部主机可以共享一个公有":[14],"地址。在这种配置类型中，支持很多内部主机只需极少的外部地址。":[14],"增强了与公有网络连接的灵活性。为了确保可靠的公有网络连接，可以实施多池、备用池和负载均衡池。":[14],"为内部网络编址方案提供了一致性。在不使用私有":[14],"的网络上，更改公有":[14],"地址方案时需要对现有网络上的所有主机重新编址。主机重新编址的成本会非常高。nat":[14],"允许维持现有的私有":[14],"地址方案，同时能够很容易地更换为新的公有编址方案。这意味着，组织可以更换":[14],"而不需要更改任何内部客户端。":[14],"隐藏用户":[14],"地址。使用":[14],"地址时，nat":[14],"具有隐藏用户和其他设备的":[14],"地址的副作用。有些人认为这是一种安全功能，但是大多数专家都认为":[14],"并不提供安全性。有状态防火墙才会在网络边缘提供安全性。":[14],"的缺点":[15],"确实有一些缺点。互联网上的主机看起来是直接与启用":[15],"设备通信，而不是与私有网络内部的实际主机通信，这一事实会造成几个问题。":[15],"的一个缺点就是影响网络性能，尤其是对实时协议（如":[15],"voip）的影响。转换数据包报头内的每个":[15],"地址需要时间，因此":[15],"会增加转发延迟。第一个数据包始终是经过较慢路径的交换过程。路由器必须查看每个数据包，以决定是否需要转换。路由器必须更改":[15],"报头，甚至可能要更改":[15],"报头。每次进行转换时，都必须重新计算":[15],"报头校验和以及":[15],"校验和。如果缓存条目存在，则其余数据包经过快速交换路径；否则也会被延迟。":[15],"的另一个缺点是端到端编址的丢失。许多互联网协议和应用程序取决于从源到目的地的端到端编址。某些应用程序不能与":[15],"配合使用。例如，一些安全应用程序（例如数字签名）会因为源":[15],"地址在到达目的地之前发生改变而失败。使用物理地址而非限定域名的应用无法到达经过":[15],"路由器转换的目标。有时，通过实施静态":[15],"映射可避免此问题。":[15],"端到端":[15],"可追溯性也会丧失。由于经过多个":[15],"地址转换点，数据包地址已改变很多次，因此追溯数据包将更加困难，排除故障也更具挑战性。":[15],"也会使隧道协议的使用变得复杂，例如":[15],"ipsec，因为":[15],"会修改标头中的值，导致完整性检查失败。":[15],"需要外部网络发起":[15],"连接的一些服务，或者无状态协议（诸如使用":[15],"的无状态协议），可能会中断。除非对":[15],"路由器进行配置来支持此类协议，否则传入的数据包将无法到达目的地。一些协议可以支持参与通信的双方中的一方采用":[15],"机制（例如被动模式":[15],"ftp），但是当两个系统均通过":[15],"与互联网分隔时，这些协议会失败。":[15],"配置静态":[16,19],"是内部地址与外部地址之间的一对一映射。静态":[16],"允许外部设备使用静态分配的公有地址发起与内部设备的连接。例如，可以将内部":[16],"服务器映射到特定的内部全局地址，以便从外部网络对其进行访问。":[16],"图":[16,21,22,23,26,27,28,33,35,40,41,42],"显示了一个包含具有私有":[16],"地址的":[16],"服务器的内部网络。路由器":[16],"上配置了静态":[16],"nat，以允许外部网络（互联网）上的设备访问":[16],"服务器。外部网络中的客户端使用公有":[16],"地址访问":[16],"服务器。静态":[16],"可以将公有":[16],"地址转换为私有":[16],"在配置静态":[16],"转换时，有两个基本任务。":[16],"步骤":[16,21,27,40],"第一个任务是建立内部本地地址与内部全局地址之间的映射。例如，图":[16],"中的内部本地地址":[16],"和内部全局地址":[16],"已配置为静态":[16],"在配置了映射后，将参与转换的接口配置为内部或外部接口（相对于":[16],"而言）。在本示例中，r2":[16],"serial":[16,35],"接口为内部接口，而":[16],"为外部接口。":[16],"对经过已配置的内部本地":[16],"到达":[16],"的内部接口":[16],"的数据包进行转换，然后将其转发到外部网络。到达":[16],"的外部接口":[16],"的数据包，其目标地址是已配置的内部全局":[16],"，将该目标地址转换为内部本地地址":[16],"，然后将数据包转发到内部网络。":[16],"列出了配置静态":[16],"所需的命令。":[16],"显示的是在示例拓扑中":[16],"在创建与":[16],"服务器的静态":[16],"映射时所需的命令。通过所示配置，r2":[16],"将来自具有地址":[16],"服务器的数据包转换到公有":[16],"5。互联网客户端向公有":[16],"发送网页请求。r2":[16],"将此流量转发到位于":[16],"服务器。":[16,17],"使用图":[16,26,27],"中的语法检查器在":[16,21],"上配置另一个静态":[16],"条目。":[16,27],"分析静态":[17],"使用上述配置，该图说明了客户端和":[17],"服务器之间的静态":[17],"转换过程。当外部网络（互联网）上的客户端需要到达内部（内联网）网络上的服务器时，通常使用静态转换。":[17],"客户端想要打开与":[17],"服务器的连接。客户端使用公有":[17],"目标地址":[17,22],"将数据包发送到":[17],"服务器。该地址是":[17],"服务器的内部全局地址。":[17],"在其":[17],"外部接口上收到来自客户端的第一个数据包，这使得":[17],"开始检查":[17],"表。目标":[17],"地址位于":[17],"表中，因此对其进行转换。":[17],"使用内部本地地址":[17],"替换内部全局地址":[17],"5。r2":[17],"随后将数据包转发到":[17,35],"服务器接收数据包，并使用内部本地地址":[17],"对客户端做出响应。":[17],"5a":[17,22],"内部接口上接收来自":[17],"服务器的数据包，该":[17],"内部接口具有":[17],"服务器内部本地地址（192":[17],"254）的源地址。":[17],"5b":[17,22],"检查":[17,45],"表，以便进行内部本地地址的转换。该地址可在":[17],"表中找到。r2":[17],"将源地址转换为内部全局地址":[17],"5，并转发以客户端为目标的数据包。":[17],"客户端接收数据包并继续会话。nat":[17],"路由器对每个数据包执行步骤":[17],"到步骤":[17],"5b。（图中未显示步骤":[17],"6。）":[17,22],"验证静态":[18],"用于验证":[18],"操作的一个有用命令是":[18],"translations。此命令可用于显示活动的":[18],"转换。与动态转换不同，静态转换始终在":[18],"表中进行。图":[18],"使用上述配置示例显示此命令的输出。由于该示例是静态":[18],"配置，因此不论正在进行的是何种通信，转换都会在":[18],"表中进行。如果此命令是正在进行会话时发出的，则输出还会表示出外部设备的地址，如图":[18],"所示。":[18,35],"另一个有用命令是":[18],"statistics。如图":[18],"所示，show":[18,29,42],"statistics":[18,23,29,40,42],"命令显示有关总活动转换数、nat":[18,23,40],"配置参数、地址池中地址数量和已分配地址数量的信息。":[18,23],"为了验证":[18],"转换是否正常工作，最好在测试前使用":[18],"clear":[18,23,40],"命令清除任何之前转换的统计信息。":[18],"在与":[18],"服务器通信之前，show":[18],"命令显示无当前点击。在客户端与":[18],"服务器建立会话后，show":[18],"显示在内部（串行":[18],"0）接口上增加到五次点击。这将验证":[18],"上是否发生了静态":[18],"配置网络中，客户端和服务器使用专用编址。然后，在含专用编址的数据包通过互联网前，需将其转换成公共编址。对于从组织外部访问的服务器，通常既分配公共静态":[19],"地址，又分配专用静态":[19],"地址。在该练习中，您将配置静态":[19],"nat，使外部设备可访问其公共地址上的内部服务器。":[19],"说明":[19,24,31],"提供内部本地地址与内部全局地址之间的永久映射，而动态":[20],"使内部本地地址与内部全局地址能够进行自动映射。这些内部全局地址通常是公有":[20],"地址。动态":[20],"使用一个公有":[20],"地址组或池来实现转换。":[20],"像静态":[20],"一样，动态":[20],"也要求对参与":[20],"的内部和外部接口进行配置。但是，静态":[20],"创建与单个地址的永久映射，而动态":[20],"使用一个地址池。":[20],"注：到目前为止，公有和私有":[20],"地址之间的转换是":[20],"的最常见用法。不过，nat":[20],"转换可在任一一对地址之间进行。":[20],"图中所示示例拓扑中，有一个内部网络使用的是来自":[20],"私有地址空间的地址。与路由器":[20],"连接的是两个":[20],"lan：192":[20],"24。在路由器":[20],"r2（边界路由器）上配置动态":[20],"nat，使用从":[20],"到":[20,26,38,39,40],"的公有":[20],"地址池。":[20],"这个公有":[20],"地址池（内部全局地址池）根据先到先得的原则，分配这些地址给内部网络中的任何设备。使用动态":[20],"时，单个内部地址将转换为单个外部地址。要进行此类转换，池中必须有足够地址以满足需要同时访问外部网络的所有内部设备。如果池中的所有地址已经用完，设备必须等待有可用地址时才能访问外部网络。":[20],"配置动态":[21,24,31],"显示用于配置动态":[21],"的步骤和命令。":[21],"pool":[21],"命令定义将会用于转换的地址池。该地址池通常是一组公有地址。这些地址是通过指明池中的起始":[21],"地址和结束":[21],"地址而定义的。netmask":[21],"prefix":[21],"length":[21],"关键字指示哪些地址位属于网络，哪些位属于该地址范围内的主机。":[21],"配置一个标准":[21],"acl，用于仅标识（允许）那些将要进行转换的地址。范围太宽的":[21],"acl":[21,27,41,42],"可能会导致意料之外的后果。请记住，每个":[21],"的末尾都有一条隐式的":[21],"deny":[21],"all":[21],"语句。":[21],"绑定":[21],"与地址池。ip":[21],"inside":[21],"source":[21],"list":[21],"access":[21,42],"number":[21],"name":[21],"命令用于绑定":[21],"与地址池。路由器使用该配置来确定哪些设备（列表）接收哪些地址（池）。":[21],"确定对于":[21,27],"哪些接口是内部接口；即任何与内部网络连接的接口。":[21],"哪些接口是外部接口；即任何与外部网络连接的接口。":[21],"显示了一个示例拓扑以及配置。当":[21],"网络上所有主机（包括":[21],"lan":[21,33,42],"lan）生成的流量进入":[21],"s0":[21,26,27],"而退出":[21],"时，这一配置将允许对其进行转换。这些主机将转换为范围为":[21],"的地址池中的一个可用地址。":[21],"显示了用于进行语法检查器配置的拓扑。使用图":[21],"上配置动态":[21],"nat。":[21],"分析动态":[22],"使用上述配置，该图演示了两个客户端和":[22],"服务器之间的动态":[22],"转换过程：":[22],"显示了从内部流向外部的流量：":[22],"源":[22],"pc2":[22,28,42],"的主机发送数据包，请求与位于公有":[22],"的服务器连接。":[22],"收到来自主机":[22],"的第一个数据包。由于此数据包是在一个内部":[22],"接口上接收的，因此":[22],"将检查":[22],"配置，以确定是否应该对其进行转换。acl":[22],"允许该数据包，因此":[22],"对数据包进行转换。r2":[22],"将检查其":[22],"表。因为此":[22],"地址的转换条目不存在，所以":[22],"确定必须动态转换源地址":[22],"10。r2":[22],"从动态地址池中选择一个可用全局地址，并创建一个转换条目":[22],"226。在":[22],"表中，最初的源":[22],"是内部本地地址，而转换后的地址是内部全局地址":[22],"对于第二台主机":[22],"10，r2":[22],"将重复以上程序，从动态地址池中选择下一个可用全局地址，并创建第二个转换条目":[22],"227。":[22],"使用转换后的内部全局地址":[22],"替换":[22],"的内部本地源地址":[22],"10。使用":[22],"转换后的地址":[22],"，对来自":[22],"的数据包执行同一过程。":[22],"显示了从外部流向内部的流量：":[22],"服务器收到来自":[22],"的数据包，使用":[22],"做出响应。当服务器收到第二个数据包时，它将使用":[22],"对":[22,42],"做出响应。":[22],"收到目标":[22],"的数据包时，它执行":[22],"表查找。使用来自表的映射，r2":[22],"将地址转换回内部本地地址":[22],"并将数据包转发到":[22],"pc2。":[22,28],"位于":[22],"和位于":[22],"接收数据包并继续会话。路由器对每个数据包执行步骤":[22],"至步骤":[22],"5。（图中未显示步骤":[22],"验证动态":[23],"所示":[23],"translations":[23,29,35,40,42],"命令的输出显示了之前两个":[23],"分配的细节。该命令显示所有已配置的静态转换和所有由流量创建的动态转换。":[23],"增加":[23],"verbose":[23],"关键字可显示关于每个转换的附加信息，包括创建和使用条目的时间长短。":[23],"转换条目默认超时时间为":[23],"小时，在全局配置模式下使用":[23],"translation":[23,40],"timeout":[23],"seconds":[23],"命令可重新配置超时时间。":[23],"要在超时之前清除动态条目，请使用":[23],"特权":[23],"exec":[23],"模式命令（图":[23],"2）。在测试":[23],"配置时清除动态条目非常有用。如表中所示，该命令可以与关键字和变量一起使用以控制清除哪些条目。可以清除特定条目以避免活动会话中断。使用":[23],"命令清除表中的所有转换。":[23],"注：该命令只会清除表中的动态转换。而不会删除转换表中的静态转换。":[23],"在图":[23],"中，show":[23],"或者使用":[23],"running":[23,42],"config":[23,42],"命令查看":[23],"nat、acl、接口或池命令。仔细检查，纠正所发现的任何错误。":[23],"在此":[24,31],"中，您将完成以下目标：":[24,31],"部分：配置动态":[24],"部分：验证":[24,31],"实施":[24,31],"实验":[25,32,44],"配置动态和静态":[25],"在本实验中，您将完成以下目标：":[25,32,44],"部分：构建网络和验证连接":[25,32],"部分：配置和验证静态":[25],"部分：配置和验证动态":[25],"配置":[26,27],"pat：地址池":[26],"pat（也称为":[26],"过载）允许路由器为许多内部本地地址使用一个内部全局地址，从而节省了内部全局地址池中的地址。换句话说，一个公有":[26],"地址可用于数百甚至数千个内部私有":[26],"地址。当配置了此类转换后，路由器会保存来自更高层协议的足够信息（例如":[26],"端口号），以便将内部全局地址转换回正确的内部本地地址。当多个内部本地地址映射到一个内部全局地址时，每台内部主机的":[26],"端口号可用于区分不同的本地地址。":[26],"注：理论上，可转换为一个外部地址的内部地址总数量可高达每个":[26],"个。不过，能被赋予单一":[26],"地址的内部地址数量约为":[26],"个。":[26],"的方法有两种，具体采用哪一种则取决于":[26],"分配公有":[26],"地址的方式。第一种分配方式是，isp":[26],"为企业分配多个公有":[26],"地址，而另一种是，它为企业分配单个":[26],"地址，使其通过该地址连接到":[26],"isp。":[26],"为公有":[26],"地址池配置":[26],"如果某个站点发出了多个公有":[26],"地址，这些地址可能是":[26],"使用的地址池的一部分。这与动态":[26],"相似，不同之处在于没有足够的公有地址可用于内部到外部地址的一对一映射。因此这个小的地址池由更多设备之间共享。":[26],"显示了使用地址池配置":[26],"的步骤。这种配置与动态、一对一":[26],"配置的主要区别是前者使用了":[26],"overload":[26,27],"关键字。overload":[26],"关键字会启用":[26],"pat。":[26,27],"所示示例配置中为名为":[26],"pool2":[26,29],"池建立了过载转换。nat":[26],"包含":[26],"范围内的地址。192":[26],"网络上的主机需要转换。s0":[26],"接口标识为内部接口，而":[26],"接口标识为外部接口。":[26],"中的语法检查器，在":[26,27],"上使用地址池配置":[26],"pat：单个地址":[27],"为单一公有":[27],"地址配置":[27],"显示了用于单个公有":[27],"地址转换的":[27],"实施的拓扑。在示例中，来自网络":[27],"的所有主机（匹配":[27],"1）通过路由器":[27],"将流量发送到互联网，这些主机地址将会转换为":[27],"225（接口":[27],"地址）。由于使用了":[27],"关键字，因此在":[27],"表中可通过端口号来识别通信流。":[27],"显示了使用单一":[27],"的步骤。如果只有一个公有":[27],"地址可用，则过载配置通常会将此公有地址分配给与":[27],"连接的外部接口。所有内部地址离开该外部接口时，均被转换为此":[27],"定义":[27],"acl，使其允许流量转换。":[27],"interface":[27],"关键字配置源转换。interface":[27],"关键字用于确定在转换内部地址时使用哪个接口":[27],"地址。overload":[27],"关键字指示路由器跟踪端口号以及每个":[27],"哪些接口是内部接口。即与内部网络连接的所有接口。":[27],"哪些接口是外部接口。这应该与步骤":[27],"的源转换语句中标识的接口相同。":[27],"配置与动态":[27],"相似，不同之处在于不是使用地址池，而是使用":[27],"关键字来识别外部":[27],"地址。因此没有定义":[27],"池。":[27],"上使用单个地址配置":[27],"分析":[28],"不论使用地址池还是使用单个地址，nat":[28],"过载过程相同。继续上述":[28],"示例，pc1":[28],"希望使用单个公有":[28],"地址与":[28],"服务器":[28],"通信。同时，另一个客户端":[28],"希望与":[28],"svr2":[28,42],"建立类似会话。pc1":[28],"都配置了私有":[28],"地址，而且为":[28],"启用":[28],"到服务器的进程":[28],"显示":[28],"分别向":[28],"发送数据包。pc1":[28],"具有源":[28],"10，而且使用":[28],"源端口":[28],"1444。pc2":[28],"11，而且恰巧为其分配了相同的源端口":[28],"1444。":[28],"来自":[28],"的数据包先到达":[28],"r2。通过使用":[28],"pat，r2":[28],"将源":[28],"地址更改为":[28],"225（内部全局地址）。nat":[28],"表中没有其他设备使用端口":[28],"1444，因此，pat":[28],"保存了相同的端口号。随后将数据包转发到位于":[28],"接着，来自":[28],"的数据包到达":[28],"r2。pat":[28],"已配置为对所有转换使用一个内部全局":[28],"225。与":[28],"的转换过程类似，pat":[28],"的源":[28],"地址更改为内部全局地址":[28],"225。但是，pc2":[28],"具有与当前":[28],"条目（pc1":[28],"的转换）相同的源端口号。pat":[28],"将增大源端口号，直到源端口号在其表中为唯一值。在本示例中，nat":[28],"表中的源端口条目和来自":[28],"的数据包收到的端口号为":[28],"尽管":[28],"使用相同的转换后地址（内部全局地址":[28],"225）和相同的源端口号":[28],"1444；但修改后的":[28],"的端口号":[28],"使":[28],"表中的每个条目都是唯一的。这在从服务器发送的数据包返回客户端时显得十分明显。":[28],"服务器到":[28],"的进程":[28],"所示，在典型的客户端":[28],"服务器互换中，svr1":[28],"分别对从":[28],"收到的请求做出响应。服务器将来自已接收数据包的源端口用作目标端口，而将源地址用作返回流量的目标地址。服务器看起来像是和位于":[28],"中的同一主机通信；但事实并非如此。":[28],"当数据包到达时，r2":[28],"使用每个数据包的目标地址和目标端口在其":[28],"表中查找唯一条目。对于来自":[28],"的数据包，目标":[28],"具有多个条目，还只有一个条目具有目标端口":[28],"1444。r2":[28],"使用其表中的条目，将数据包的目标":[28],"10，而目标端口无需更改。随后将数据包转发到":[28],"当来自":[28],"时，对其执行类似转换。找到了目标":[28],"225，仍具有多个条目。但是，使用目标端口":[28],"1445，r2":[28],"能够唯一确定转换条目。目标":[28],"地址已更改为":[28],"11。在这种情况下，目标端口也必须修改回":[28],"表中存储的它的原始值":[28],"1444。随后将数据包转发到":[28],"验证":[29,43],"已将路由器":[29],"配置为向":[29],"客户端提供":[29],"pat。当内部主机离开路由器":[29],"进入互联网时，将其转换为来自":[29],"池的带有唯一源端口号的":[29],"所示，用于验证":[29],"的命令和用于验证静态和动态":[29],"的命令相同。show":[29],"命令用于显示从两个不同主机到不同":[29],"服务器的转换。注意，为两台不同的内部主机分配了同一个":[29],"226（内部全局地址）。nat":[29],"表中的源端口号将这两个转换区分开来。":[29],"命令用于验证":[29],"是否为两个转换分配了单个地址。输出中所包含的是有关活动转换的数量和类型、nat":[29],"配置参数、地址池中的地址数量以及已分配的地址数量的信息。":[29],"确定每一跳的地址信息":[30],"实施静态":[31],"和动态":[31],"部分：利用":[31],"部分：配置静态":[31],"实施静态和动态":[31],"配置端口地址转换":[32],"部分：配置和验证":[32],"池重载":[32],"端口转发":[33],"端口转发是将发送到特定网络端口的流量从一个网络节点转发到另一个网络节点的行为。这种技术允许外部用户从外部网络通过启用":[33],"的路由器到达私有":[33],"地址（lan":[33],"内部）上的端口。":[33],"通常来说，为了让点对点文件共享程序以及":[33],"服务和送出":[33],"ftp":[33],"等操作能够工作，需要转发或打开路由器端口，如图":[33],"所示。因为":[33],"隐藏了内部地址，所以点对点只能以从内到外的方式工作，nat":[33],"在外部可以建立送出请求与传入回复之间的映射。":[33],"问题是，nat":[33],"不允许从外部发起请求。通过手动干预可以解决这个问题。可以配置端口转发来标识可转发到内部主机的特定端口。":[33],"回忆一下，互联网软件应用程序与用户端口互动时，用户端口需打开或可供应用程序使用。不同的应用程序使用不同的端口。这样可以预测应用程序并可以使路由器确定网络服务。例如，http":[33],"在公认端口":[33],"上运行。当有人输入地址":[33],"http":[33,34,36],"cisco":[33],"com":[33,34],"时，浏览器将显示":[33],"systems":[33],"inc":[33],"网站。注意，我们无需指定网页请求的":[33],"端口号，因为应用程序假定端口号为":[33],"如果需要不同端口号，可将其附加到":[33],"url":[33],"上，以冒号":[33],"进行分隔。例如，如果":[33],"服务器是在端口":[33],"上侦听，则用户将键入":[33],"www":[33,34],"example":[33,34],"8080。":[33],"利用端口转发，互联网上的用户能够使用路由器的":[33],"wan":[33,34],"端口地址和相匹配的外部端口号来访问内部服务器。通常为内部服务器配置":[33],"地址。当一个请求通过互联网发送到":[33],"端口的":[33],"地址时，路由器会将该请求转发到":[33],"上的相应服务器。为安全起见，宽带路由器默认不允许转发任何外部网络请求转发到内部主机。":[33],"显示一个小型企业主使用销售点":[33],"pos":[33],"服务器来跟踪店里的销售和库存。可以在店内访问服务器，但由于它具有私有":[33],"地址，因此无法从互联网公开访问。启用本地路由器以进行端口转发，使店主可以从任何地点在互联网上访问销售点服务器。使用销售点服务器的目标端口号和私有":[33],"地址配置路由器上的端口转发。为了访问服务器，客户端软件将使用路由器的公有":[33],"地址和服务器的目标端口。":[33],"无线路由器示例":[34],"该图显示了":[34],"无线路由器的单端口转发配置窗口。默认情况下，路由器上未启用端口转发。":[34],"可以通过指定转发请求时应当使用的内部本地地址来为应用程序启用端口转发。在图中，进入无线路由器的":[34],"服务请求将转发到内部本地地址为":[34],"服务器。如果无线路由器的外部":[34],"225，则外部用户可以输入":[34],"com，无线路由器会把该":[34],"请求重定向到位于":[34],"的内部":[34],"服务器，使用默认端口号":[34],"可以指定除默认端口":[34],"之外的其他端口。但是，外部用户必须知道所使用的特定端口号。要指定其他端口，需要修改":[34],"单一端口转发":[34],"窗口中":[34],"外部端口":[34],"的值。":[34],"配置端口转发的方法取决于网络上宽带路由器的品牌和型号。不过，有一些步骤是通用的。如果":[34],"提供的说明或路由器附带的说明未提供足够的指导，网站":[34],"portforward":[34],"提供了多种宽带路由器的指南。您可以按照说明，根据需要添加或删除端口，以满足您想允许或拒绝的任何应用程序的需要。":[34],"ios":[35],"配置端口转发":[35],"命令实施端口转发与用于配置静态":[35],"的命令类似。端口转发实质上是与已指定":[35],"端口号的静态":[35],"显示了在使用":[35],"配置端口转发时使用的静态":[35],"命令。":[35,40],"显示了在路由器":[35],"上使用":[35],"命令配置端口转发的示例。192":[35],"是在端口":[35],"上侦听的":[35],"服务器的内部本地":[35],"地址。用户将使用全局":[35],"225（全局唯一公有":[35],"地址）访问此内部":[35],"服务器。在本例中，这一地址为":[35],"上":[35],"接口的地址。全局端口已配置为":[35],"8080。这是目标端口，与":[35],"的全局":[35],"地址一起用于访问内部":[35],"服务器。在":[35],"配置中注意以下命令参数：":[35],"local":[35],"port":[35],"global":[35],"如果没有使用公认端口号，则客户端必须在应用程序中指定端口号。":[35],"与":[35,38],"的其他类型类似，端口转发要求同时配置内部和外部":[35],"接口。":[35],"与静态":[35],"相似，show":[35],"命令可用于验证端口转发，如图":[35],"在本示例中，当路由器接收内部全局":[35],"并且":[35],"目标端口为":[35],"的数据包时，路由器将使用目标":[35],"地址和目标端口作为索引来执行":[35],"表查找。然后路由器将该地址转换为主机的内部本地地址":[35],"和目标端口":[35],"80。r2":[35],"服务器。对于从":[35],"服务器返回到客户端的数据包，此过程正好相反。":[35],"配置无线路由器上的端口转发":[36],"您的朋友想要在您的服务器上与您一起玩游戏。你们在各自的家中，并且连接了互联网。您需配置无线路由器，以便端口转发":[36],"请求至服务器，从而让您的朋友能够访问游戏大厅网页。":[36],"配置无线路由器上的端口转发说明":[36],"用于":[37,39],"自":[37],"世纪":[37],"年代早期开始，有关":[37],"地址空间消耗的问题就已成为":[37],"ietf":[37,38],"首要关注的问题。rfc":[37],"的结合有力地减缓了地址消耗的速度。但是":[37],"有很大的弊端，在":[37],"年":[37],"月，iana":[37],"将它的最后一个":[37],"地址分配给了":[37],"rir。":[37],"的一个优点是它无意中对公有互联网隐藏了私有网络。nat":[37],"的优势在于它通过拒绝公有互联网上的计算机访问内部主机，从而提供了一定级别的安全性。但是，不应将其视为适当网络安全设置（例如防火墙提供的安全设置）的替代物。":[37],"中，互联网基础架构委员会":[37],"iab":[37],"对于":[37],"网络地址转换包含以下引述：":[37],"通常认为":[37],"进程可以提供一定级别的保护，因为外部主机无法直接与":[37],"后面的主机发起通信。然而，不应将":[37],"进程与防火墙相混淆。如":[37],"rfc4864":[37],"中的第":[37],"部分所述，转换行为本身并不提供安全性。有状态过滤功能可以提供相同级别的保护，而无需具备转换功能":[37],"具有":[37],"位地址的":[37],"可以提供":[37],"涧（10":[37],"次方）个地址。因此，不会出现地址空间耗尽问题。ipv6":[37],"的开发使用于":[37],"以及公有和私有":[37],"地址之间的转换不再必要。不过，ipv6":[37],"确实会实施一种形式的":[37],"nat。ipv6":[37],"同时包括其自身的":[37],"私有地址空间和":[37],"nat，其实施与在":[37],"中的实施方式不同。":[37],"唯一本地地址":[38],"ula":[38],"中的":[38],"私有地址相似，但是也有着重大差异。ula":[38],"的目的是为本地站点内的通信提供":[38],"地址空间；而不是为了提供额外的":[38],"地址空间，也不是为了提供一定级别的安全性。":[38],"如图所示，ula":[38],"拥有前缀":[38],"fc00":[38],"7，这将产生第一个十六进制数的范围":[38],"fdff。如果该前缀是本地分配的，则接下来的":[38],"位将设置为":[38],"1。设置为":[38],"的情况将在以后进行定义。之后的":[38],"位是全局":[38],"id，然后是":[38],"位的子网":[38],"id。以上前":[38],"位结合在一起，形成":[38],"前缀。这样，剩余的":[38],"位保留为接口":[38],"id，或者在":[38],"术语中为地址的主机部分。":[38],"中定义唯一本地地址。ula":[38],"也称为本地":[38],"地址（不要与":[38],"本地链路地址相混淆），具有几个特性，包括：":[38],"允许站点进行合并或私下互连，而不会产生任何地址冲突或要求使用这些前缀对接口进行重新编号。":[38],"独立于任何":[38],"isp，而且可用于站点内通信，无需进行互联网连接。":[38],"不可通过互联网路由，但是如果无意中因路由或":[38],"dns":[38],"而泄露出去，也不会与其他地址发生冲突。":[38],"并不像":[38],"地址一样完全直接转发。与":[38],"地址不同，ietf":[38],"的目的并不是使用":[38],"的一种形式来进行唯一本地地址和":[38],"全局单播地址之间的转换。":[38],"唯一本地地址的实施和潜在用途仍由互联网社区进行检查。例如，ietf":[38],"正在考虑允许在使用":[38],"前缀时集中分配":[38],"位全局":[38],"id、在使用":[38],"前缀":[38],"fd00":[38],"时随机生成或手动分配":[38],"的选项。地址的其余部分保持不变。我们仍为子网":[38],"位，为接口":[38],"位。":[38],"注：最初的":[38],"规范为本地站点地址分配地址空间，这在":[38],"中进行了定义。后来":[38],"中弃用了本地站点地址，因为":[38],"站点":[38],"这一术语不太明确。本地站点地址的前缀范围为":[38],"fec0":[38],"10，可能在某些较早的":[38],"文档中仍能见到。":[38],"与用于":[39],"使用背景大不相同。用于":[39],"变体用来透明地提供仅支持":[39],"和仅支持":[39],"的网络之间的访问。而不是用作一种私有":[39],"到全局":[39],"的转换。":[39],"理想情况下，只要有可能，ipv6":[39],"就应当在本地运行。这意味着":[39],"设备将通过":[39],"网络相互通信。但是，为了帮助实现从":[39],"的转移，ietf":[39],"已经开发了多项过渡技术以满足各种":[39],"的转移情景，包括双堆栈、隧道和转换。":[39],"双堆栈是指设备运行与":[39],"都相关的协议。ipv6":[39],"隧道是指将":[39],"数据包封装到":[39],"数据包中的过程。这将使":[39],"数据包能够通过仅支持":[39],"的网络传输。":[39],"不应当作为一种长期策略使用，但可作为一种临时机制来帮助进行":[39],"的迁移。多年来，已经开发了多个用于":[39],"的类型，包括网络地址转换":[39],"协议转换":[39],"pt":[39],"。ietf":[39],"已弃用":[39],"pt，开始倾向于其替代者":[39],"nat64。nat64":[39],"不属于本课程的范围。":[39],"命令":[40,41],"显示为":[40],"启用了":[40],"r2，使用的地址范围为":[40],"240。":[40],"环境中发生连通性问题时，经常难以确定问题的原因。解决问题的第一步便是检查":[40],"是否为故障的原因。请执行下列步骤来验证":[40],"是否按预期正常工作：":[40],"根据配置，清楚地确定应该实现什么样的":[40],"nat。这可能会揭示出配置问题。":[40],"命令验证转换表中转换条目是否正确。":[40],"命令验证":[40],"是否如预期一样工作。检查动态条目被清除后，是否又被重新创建出来。":[40],"详细审查数据包传送情况，确认路由器具有移动数据包所需的正确路由信息。":[40],"命令的输出。在使用":[40],"命令之前，可以使用":[40],"命令清除":[40],"统计信息和":[40],"表中的条目。在位于":[40],"的主机通过":[40],"telnet":[40],"连接到位于":[40],"的服务器上之后，将显示":[40],"表，以验证":[40],"是否如预期一样工作。":[40],"在简单的网络环境中，使用":[40],"命令监控":[40],"统计信息会很有用。show":[40],"配置参数、地址池中地址数量和已分配地址数量的信息。但是，在有多个转换的更复杂的":[40],"环境中，该命令可能无法清楚地识别问题。可能需要在路由器上运行debug":[40],"命令显示关于被路由器转换的每个数据包的信息，验证":[41],"功能的运作。debug":[41],"detailed":[41],"命令会产生关于要进行转换的每个数据包的说明。此命令还会提供关于某些错误或异常状况的信息，例如分配全局地址失败等。debug":[41],"命令会比":[41],"命令产生更多开销，但它可以提供在排除":[41],"故障时可能需要的详细信息。请务必在完成后关闭调试。":[41],"命令的输出示例。输出显示，内部主机":[41],"向外部主机":[41],"发起流量，而且源地址已转换为地址":[41],"解读调试输出时，注意下列符号和值的含义：":[41],"（星号）":[41],"旁边的星号表示转换发生在快速交换路径。会话中的第一个数据包始终经过过程交换，因而较慢。如果缓存条目存在，则其余数据包经过快速交换路径。":[41],"s":[41],"该符号是指源":[41],"a":[41],"b":[41],"c":[41],"d":[41],"w":[41],"x":[41],"y":[41],"z":[41],"该值表示源地址":[41],"已转换为":[41],"z。":[41],"该符号是指目标":[41],"xxxx":[41],"中括号中的值表示":[41],"标识号。此信息可能对调试有用，因为它与协议分析器的其它数据包跟踪相关联。":[41],"注：验证":[41],"命令中引用的":[41],"是否允许所有必需的网络。图":[41],"中，只有地址":[41],"具有转换资格。数据包从内部网络发往互联网，其源地址未得到":[41],"的明确允许，因此":[41],"没有对该源地址进行转换。":[41],"故障排除场景":[42],"案例研究":[42],"显示来自":[42],"的主机":[42],"无法对外部网络上的服务器":[42],"进行":[42],"ping":[42],"操作。":[42],"在开始对该问题进行故障排除时，请使用":[42],"命令查看目前":[42],"表中是否存在任何转换。图":[42],"中的输出显示表中无任何转换。":[42],"命令用于确定是否发生了任何转换。它还可以确定应当在哪些接口之间进行转换。如图":[42],"输出所示，nat":[42],"计数器显示":[42],"0，即表示未发生任何转换。通过将该输出与图":[42],"所示拓扑进行比较，会注意到路由器接口错误地定义为":[42],"内部接口或":[42],"外部接口。也可以使用":[42],"命令验证出这一错误配置。":[42],"在应用正确配置之前，必须从接口上删除当前":[42],"接口配置。":[42],"在正确定义了":[42],"内部接口和外部接口后，再次从":[42],"执行":[42],"操作，ping":[42],"操作仍然失败。再次使用":[42],"命令验证是否仍未发生转换。":[42],"lists":[42],"命令可用于确定":[42],"命令参考中的":[42],"是否允许所有必需的网络。检查输出，输出指示用于定义需要转换的地址的":[42],"中使用了错误的通配符位掩码。通配符掩码只允许":[42],"子网。先删除访问列表，然后使用正确的通配符掩码重新配置。":[42],"在更正了配置后，再次从":[42],"操作，这次":[42],"操作成功。如图":[42],"命令用于验证是否发生了":[42],"配置并进行故障排除":[43],"承包商将较早的配置恢复至新运行":[43],"的路由器。但是，网络已发生变化，而且在旧配置备份之后添加了新子网。您需要让网络再次工作。":[43],"验证并排除":[43],"配置故障说明":[43],"配置故障":[43],"配置故障排除":[44],"部分：建立网络并配置设备的基本设置":[44],"部分：静态":[44],"故障排除":[44],"部分：动态":[44],"目前您的公司的网络设计中并未包括网络地址转换。已决定将某些设备配置为使用":[45],"服务，用于连接至邮件服务器。":[45],"在网络上实时部署":[45],"前，使用网络仿真程序进行原型塑造。":[45],"有关该实验的进一步说明，请参阅本练习随附的":[45],"pdf。":[45],"检查说明":[45],"综合技能练习":[46],"本总结练习包括您在本课程中获得的许多技能。首先，您需要完成网络文档。所以，请确保您有说明的打印版本。在实施期间，您需要配置交换机上的":[46],"vlan、中继、端口安全和":[46],"远程访问。接下来，您将在路由器上实施":[46],"vlan":[46],"间路由和":[46],"nat。最后，您需要使用文档通过测试端到端连接验证实施。":[46],"综合技能练习说明":[46],"本章概述如何使用":[47],"帮助缓解":[47],"地址空间耗尽的问题。用于":[47],"允许网络管理员使用":[47],"私有地址空间，同时使用单个或数量有限的公有地址提供互联网连接。":[47],"可以节约公有地址空间，并节省相当大的添加、移动和更改等管理开销。可实施":[47],"来节约公共地址空间，而不会影响":[47],"连接。但是，nat":[47],"的缺点在于它对设备性能、移动性和端到端连通性产生的负面影响，因此应将其视为针对地址耗尽问题采取的短期实施，而长期解决方案是使用":[47],"ipv6。":[47],"本章讨论用于":[47],"nat，包括：":[47],"pat、动态":[47],"为什么":[47],"可用但不是":[47],"网络所必需的":[47]}}