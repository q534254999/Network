{"list":["6.0.1.1","6.0.1.2","6.1.1.1","6.1.1.2","6.1.2.1","6.1.2.2","6.1.2.3","6.1.2.4","6.1.2.5","6.1.2.6","6.1.3.1","6.1.3.2","6.1.3.3","6.1.4.1","6.1.4.2","6.1.4.3","6.1.4.4","6.1.4.5","6.1.4.6","6.2.1.1","6.2.1.2","6.2.1.3","6.2.1.4","6.2.2.1","6.2.2.2","6.2.2.3","6.2.2.4","6.2.2.5","6.2.2.6","6.2.2.7","6.2.2.8","6.3.1.1","6.3.1.2","6.3.1.3","6.3.1.4","6.3.1.5","6.3.1.6","6.3.1.7","6.3.1.8","6.3.2.1","6.3.2.2","6.3.2.3","6.3.2.4","6.3.2.5","6.3.2.6","6.3.2.7","6.4.1.1","6.4.1.2","6.4.1.3","6.4.2.1","6.4.2.2","6.4.3.1","6.4.3.2","6.4.3.3","6.4.3.4","6.5.1.1","6.5.1.2","6.5.1.3","6.5.1.4"],"map":{"0":[16,19,26,27,28,33,49,51],"1":[4,6,10,15,27,28,36,40,45,46,47,49,50,51,52,54,55,56],"2":[4,6,15,28,33,36,40,45,46,47,49,50,51,52,54,56],"3":[2,10,15,31,40,47,49,54,55,56,58],"4":[2,3,5,10,14,16,47,54],"5":[15,47,54],"6":[0,3,10,14,47,58],"8":[10,15,16],"10":[21,26,27,28,51],"11":[51],"12":[15],"15":[26,55],"16":[16],"17":[10],"20":[14,15,16],"32":[10,14,58],"36":[14],"40":[13,15],"60":[15],"90":[14],"127":[19],"128":[14,16,58],"165":[28],"168":[21,26,51],"192":[21,26,51],"200":[28],"209":[28],"211":[14],"240":[49],"256":[33],"282":[14],"294":[14],"296":[14],"340":[14],"366":[14],"374":[14],"431":[14],"456":[14],"463":[14],"512":[33],"607":[14],"768":[14],"920":[14],"938":[14],"967":[14],"1841":[34],"1941":[32,33,35,49,55],"2960":[55],"3900":[31],"7600":[31],"第":[0,2,45,54,56,58],"章：网络层":[0,58],"一台终端设备上的网络应用程序和服务可以与另一台终端设备上运行的应用程序和服务通信。这种数据如何在网络间有效通信？":[0],"osi":[0,2,8,58],"模型网络层协议指定了用于传输层数据的封装和传输的编址与过程。网络层封装能够以最低的开销将数据传递到同一网络中的目的地（或其他网络中的目的地）。":[0],"本章着重介绍网络层的作用。其中将探讨如何把网络分为不同的主机组，以便管理网络内的数据包流。此外还介绍了如何实现网络之间的通信。网络之间的这种通信称为路由。":[0],"课堂练习":[1,55],"较短路径传送":[1],"或者是？":[1],"在即将到来的周末，您决定去探访一个生病在家的同学。您知道他的街道地址但是从来没到过他所在的城镇。您决定不从地图上查找地址，而是下火车后跟当地居民打听方向。为您指路的居民都能提供帮助。但是他们都有一个有趣的习惯。他们不会直接向您解释到达目的地的整个路由，而是告诉您":[1],"这条路走到最近的交叉路口，再在那儿向其他人问路。":[1],"带着对这种怪癖的困惑，您遵循他们的指引，经过了一个又一个交叉路口，一条又一条马路，最终到达您朋友的房门前。":[1],"请回答以下问题：":[1],"如果这些指路人告诉您的是整个路由或者是比只到最近的交叉路口更长一些的路由，结果与现在会有重大区别吗？":[1],"询问具体的街道地址或只询问街道名称会不会更有帮助？如果您问方向的人不知道目的街道或者把您指向了错误的路，将会发生什么情况？":[1],"假设，在回家时，您仍然选择向当地居民问路。能够保证指路人会指引同一路径到达您朋友家吗？请给出您的解释。":[1],"在询问如何到达目的地时，是否有必要解释您是从哪儿出发的？":[1],"或者是？说明":[1],"网络层":[2],"网络层即":[2,58],"层，提供能够让终端设备跨整个网络交换数据的服务。为了实现这种端到端传输，网络层使用了四个基本过程：":[2],"终端设备编址":[2],"必须为终端设备配置唯一的":[2],"ip":[2,4,5,6,7,8,9,10,13,14,19,20,22,23,24,26,36,50,51,52,54,55,58],"地址，以便在网络上进行识别。":[2],"封装":[2,4,15],"网络层将来自传输层的协议数据单元":[2],"pdu":[2,4,8],"封装到数据包中。封装过程中会添加":[2],"报头信息，例如来源（发送）和目的（接收）主机的":[2],"地址。":[2,16,26,50,52],"路由":[2],"网络层提供服务，将数据包转发至另一网络上的目的主机。要传送到其他网络，数据包必须经过路由器的处理。路由器的作用是为数据包选择最佳路径，并将其转发至目的主机，该过程称为路由。数据包可能需要经过很多中间设备才能到达目的主机。数据包在到达目的主机的过程中经过的每个路由器均称作一跳。":[2],"解封":[2],"当数据包到达目的主机的网络层时，主机会检查数据包的":[2],"报头。如果在报头中的目的":[2],"地址与其自身的":[2],"地址匹配，ip":[2],"报头将会从数据包中删除。网络层解封数据包后，后继的第":[2],"层":[2],"会向上传递到传输层的相应服务。":[2],"传输层（osi":[2],"层）负责管理每台主机上的运行进程之间的数据传输，而网络层协议则指定从一台主机向另一台主机传送数据时使用的数据包结构和处理过程。网络层工作时无需考虑每个数据包中所携带的数据，这使其能够为多台主机之间的多种类型的通信传送数据包。":[2],"单击图中的":[2,11,17,25,29,41,43],"播放":[2,11,17,25,29,41,43],"，观看演示数据交换过程的动画。":[2],"网络层协议":[3],"目前存在许多网络层协议。但是，如图所示，通常实施的网络层协议只有两种：":[3],"internet":[3,10,13,58],"协议版本":[3],"ipv4":[3,4,10,11,12,13,14,15,16,19,21,22,24,25,26,28,29,36,50,52,58],"ipv6":[3,4,14,15,16,17,18,22,58],"注意：图中没有显示传统网络层协议，本课程不做讨论。":[3],"通过添加":[4],"报头将传输层数据段或其他数据进行封装。此报头用于将数据包传送到目的主机。从数据包离开源主机直至其到达目的主机，ip":[4],"报头始终保持不变。":[4],"图":[4,47,49,50,51,52],"显示了创建传输层":[4],"的流程。图":[4],"显示了网络层":[4],"如何封装传输层":[4],"来创建":[4],"数据包。":[4,10,16],"按层封装数据层的流程使我们可以开发和扩展位于不同层的服务而不影响其他层。这意味着传输层数据段可以随时通过":[4],"或":[4,14,22,28,36,52],"进行封装，或使用未来可能开发出的任何新协议进行封装。":[4],"路由器可以实施这些不同的网络层协议，使其通过网络同时运行。这些中间设备所执行的路由只考虑网络层数据包报头的内容。在任何情况下，数据包的数据部分，即封装的传输层":[4],"pdu，在网络层的各个过程中都保持不变。":[4],"特征":[5,9],"被设计为一种低开销协议。它只提供通过互连网络系统从源主机向目的主机传送数据包所必需的功能。该协议并不负责跟踪和管理数据包的流动。这些功能（如果需要）由其他层的其他协议（主要是第":[5],"层的":[5],"tcp）执行。":[5],"图中描述了":[5],"的主要特征。":[5],"无连接":[6],"是无连接协议，这意味着发送数据前没有创建专用的端到端连接。如图":[6],"所示，无连接通信概念类似于不事先通知收件人就邮寄信件。":[6],"无连接数据通信按照同样的原理工作。如图":[6],"所示，ip":[6],"在转发数据包前，并不需要初步交换控制信息来创建端到端连接。ip":[6],"也不需要报头中包含其他字段来维持建立的连接。此过程显著降低了":[6],"的开销。但是，由于没有预先建立端到端连接，发送数据包时，发送方不知道目的设备是否存在和正常运行，同时发送数据包时，也不会知道目标设备是否接收数据包，或者，目标设备是否可以访问并读取数据包。":[6],"尽力交付":[7],"图中显示了":[7,34],"协议不可靠或尽力交付的特征。ip":[7],"协议不保证交付的所有数据包都能收到。":[7],"不可靠表示":[7],"不具备管理和恢复未送达数据包或已损坏数据包的能力。这是因为，在根据传输位置信息传输":[7],"数据包时，数据包不包含可以经过处理以通知发送方信息交付是否成功的消息。传送到时，数据包可能已经损坏或顺序错乱，或者根本就没有传送成功。如果出错，ip":[7],"无法重新传输数据包。":[7],"如果数据包顺序错乱或丢失，则使用数据或上层服务的应用程序必须解决这些问题。这让":[7],"可以非常有效地发挥作用。在":[7],"tcp":[7,19,22],"协议簇中，传输层负责保证可靠性。":[7],"介质无关性":[8],"的运作与在协议栈低层传送数据的介质无关。如图所示，ip":[8],"数据包既可以作为电信号通过铜缆传送，也可以作为光信号通过光纤传送或作为无线电信号无线传送。":[8],"数据链路层负责接收":[8],"数据包并准备在通信介质上传输它。这就意味着":[8],"数据包的传输不限于任何特定的介质。":[8],"但是，网络层会考虑介质的一个重要特征：每种介质可以传输的最大":[8],"大小。此特征称为最大传输单位":[8],"mtu":[8,10],"。数据链路层和网络层之间的部分控制通信就是确定数据包的最大尺寸。数据链路层将":[8],"值向上传送到网络层。网络层会由此确定可以传送的数据包的大小。":[8],"有时，中间设备（通常是路由器），在将数据包从一个介质转发到具有更小":[8],"的介质时，必须分割数据包。此过程称为数据包分段或分段。":[8],"练习":[9,12,18,30,37,44],"数据包报头":[10,16],"数据包报头是由包含重要数据包信息的字段组成。这些字段中包含的二进制数字由第":[10],"层进程进行检查。每个字段的二进制值均用于确定":[10],"数据包的各种设置。协议报头图（从左到右、从上到下阅读）可提供在讨论协议字段时参考的直观图。图中的":[10],"协议报头图标识了":[10],"数据包中的字段。":[10],"报头中的重要字段包括：":[10],"版本":[10,14,16,58],"包含一个":[10],"位二进制值":[10,16],"0100，用于标识这是":[10],"区分服务或":[10],"diffserv":[10],"ds":[10,16],"以前称为服务类型":[10],"tos":[10],"字段，ds":[10],"字段是一个用于确定每个数据包优先级的":[10],"位字段。diffserv":[10],"字段的六个最高有效位是区分服务代码点":[10],"dscp":[10],"，而后两位是显式拥塞通知":[10],"ecn":[10],"位。":[10,14],"生存时间":[10],"ttl":[10,16],"包含用于限制数据包寿命的一个":[10],"位二进制值。数据包发送方设置初始":[10],"值，数据包每经过一次路由器处理，数值就减少一。如果":[10],"字段的值减为零，则路由器将丢弃该数据包并向源":[10],"地址发送":[10],"控制消息协议":[10],"icmp":[10],"超时消息。":[10],"协议":[10,16],"字段用于确定下一级协议。此":[10],"位二进制值表示数据包包含的数据负载类型，使网络层将数据传送到相应的上层协议。常用的值包括":[10],"、tcp":[10],"和":[10,14,21,28,31,36,40,49],"udp":[10],"。":[10,31],"源":[10,16],"地址":[10,16,19,21],"包含表示数据包源":[10],"地址的":[10,20],"位二进制值。源":[10],"地址始终为单播地址。":[10],"目的":[10,16],"包含表示数据包目的":[10],"位二进制值。目的":[10],"地址为单播、组播或广播地址。":[10],"两种最常参考的字段是源和目的":[10],"地址。这些字段用于确定数据包的源位置和目的位置。通常，在从源传输到目的地期间，这些地址不会改变。":[10],"互联网报头长度":[10],"ihl":[10],"、总长度和报头校验和字段用于识别和验证数据包。":[10],"其他字段用于重新排列分段的数据包。具体而言，ipv4":[10],"数据包使用标识符、标志和片偏移量字段跟踪分段。路由器从一种介质向具有较小":[10],"的另一种介质转发数据包时必须将数据包分段。":[10],"注意：选项和填充字段很少使用，因此不在本章的介绍范围之内。":[10],"视频演示":[11,17,25,29,41,43],"wireshark":[11,17],"中的示例":[11],"报头":[11],"，观看在":[11,17],"捕获中检查":[11,17],"报头的演示。":[11,17],"单击此处下载演示中使用的":[11,17],"捕获和注释的":[11,17],"pdf":[11,17],"文件。":[11,17],"单击此处可阅读本视频的脚本。":[11,17,25,29,41,43],"报头字段":[12,18],"的局限性":[13],"多年来，ipv4":[13],"不断更新以迎接新的挑战。但是，尽管经历了多次变更，ipv4":[13],"仍然有三个重要问题：":[13],"地址耗尽":[13],"的可用唯一公有":[13],"地址数量有限。尽管有大约":[13],"亿的":[13],"地址，但是支持":[13],"的新设备数量的不断增加，以及始终在线的连接的增加和欠发达地区的潜在连接的增加不断催生更多的地址需求。":[13],"路由表膨胀":[13],"路由器使用路由表确定最佳路径。随着连接到":[13],"的服务器数量增加，网络路由的数量也不断增加。这些":[13],"路由消耗":[13],"路由器上的大量内存和处理器资源。":[13],"缺乏端到端连接":[13],"网络地址转换":[13],"nat":[13,14],"是":[13],"网络中经常实施的一项技术。nat":[13],"为多种设备共享单一的公有":[13],"地址提供方法。但是，因为共享了公有":[13],"地址，内部网络主机的":[13],"地址会隐藏起来。这会给需要端到端连接的技术造成难题。":[13],"简介":[14],"早在":[14],"世纪":[14],"年代早期，互联网工程任务组":[14],"ietf":[14],"就增加了对":[14],"相关问题的关注并开始寻找替代方案。这促使了":[14],"的开发。ipv6":[14,58],"解决了":[14],"的限制并有着显著的功能提升，它能更好地适应当前和可预见的网络需求。":[14],"的功能提升包括：":[14],"更大的地址空间":[14],"地址基于":[14,58],"位分层编址，而":[14,58],"采用的是":[14,58],"改进数据包处理过程":[14],"报头简化为更少的字段。":[14],"消除了对":[14],"的需求":[14],"有了数额如此巨大的公有":[14],"地址，私有":[14],"地址和公有":[14],"地址之间不再需要":[14],"nat。这可避免需要端到端连接的应用程序遇到某些由":[14],"引起的应用程序故障。":[14],"位的":[14],"地址空间提供大约":[14],"个唯一地址。如图所示，ipv6":[14],"地址空间提供":[14],"涧（10":[14],"的":[14,16,27,33,49,51,52],"次方）个地址，数量大约相当于地球上的沙粒数量。":[14],"图中提供了":[14],"地址空间的可视比较。":[14],"较":[15],"的一个重大改进是简化的":[15],"报头。":[15],"例如，图":[15],"显示的":[15],"报头包含":[15],"个二进制八位数（如果使用":[15],"选项":[15],"字段，则高达":[15],"字节）和":[15],"个基本报头字段（不包括":[15],"字段和":[15],"填充":[15],"字段）。正如图中突出显示，对于":[15],"ipv6，某些字段保持不变，某些字段的名称和位置发生了变化，而某些":[15],"字段不再需要。":[15],"相比而言，图":[15],"显示的简化":[15],"个二进制八位数（主要为源和目的":[15],"地址的长度）和":[15],"个报头字段（3":[15],"个":[15],"基本报头字段和":[15],"个附加报头字段）。正如图中突出显示，某些":[15],"字段的名称保持不变，某些字段的名称或位置发生了变化，并且添加了一个新字段。":[15],"正如图":[15],"所示，相对于":[15],"报头，ipv6":[15],"的简化报头有若干优势。":[15],"数据包报头中的字段包括：":[16],"此字段包含一个":[16],"0110，用于标识这是":[16],"流量类别":[16],"此":[16],"位字段相当于":[16],"区分服务":[16],"字段。":[16],"流量标签":[16],"位字段建议带有相同流量标签的所有数据包收到路由器的相同处理。":[16],"负载长度":[16],"位字段表示":[16],"数据包的数据部分或负载的长度。":[16],"下一报头":[16],"字段。它表示数据包传送的数据负载类型，使网络层将数据传送到相应的上层协议。":[16],"跳数限制":[16],"位字段取代":[16],"字段。每个转发数据包的路由器均会使此数值减一。当跳数达到":[16],"时，会丢弃此数据包，并且会向发送主机转发":[16],"icmpv6":[16],"超时消息来指明数据包未到达目的地，因为超过跳数限制。":[16],"位字段用于确定发送主机的":[16],"位字段用于确定接收主机的":[16],"数据包还可能包含扩展报头":[16],"eh":[16],"，以便提供可选的网络层信息。扩展报头为可选项，位于":[16],"报头及负载之间。eh":[16],"用于分段、安全性、移动性支持等。":[16],"与":[16],"不同，路由器不会对路由的":[16],"数据包进行分段。":[16],"示例":[17],"报头和":[17],"主机转发决策":[19],"网络层的另一个作用是在主机之间转发数据包。主机可以将数据包发送至：":[19],"自身":[19],"主机会将数据包发送到一个称作环回接口的特殊":[19],"1，以对自身执行":[19],"ping":[19,50],"操作。对环回接口执行":[19],"操作可以测试主机上的":[19],"协议堆栈。":[19],"本地主机":[19],"该主机与发送主机位于同一本地网络。这些主机共享同一个网络地址。":[19],"远程主机":[19],"这是位于远程网络上的主机。这些主机不共享同一个网络地址。":[19],"源（或发送）设备":[19],"地址和子网掩码的组合以及目的设备的":[19],"地址和子网掩码确定了数据包是发送给本地主机还是远程主机。":[19],"在家庭或企业网络中，您可能有若干通过中间设备（lan":[19],"交换机和":[19],"或无线接入点":[19],"wap":[19],"等）互联的有线和无线设备。这种中间设备在本地网络上的本地主机之间提供互联服务。本地主机可以互相访问和共享信息，无需任何附加设备。如果主机发送数据包到与主机设备配置有相同":[19],"网络的设备，则数据包仅是转发出主机接口，然后经过中间设备即可直接到达目的设备。":[19],"当然，在大多数情况下我们希望我们的设备不仅仅能够连接本地网段，还能连接其他家庭、企业和":[19],"internet。位于本地网段外的设备称为远程主机。如果源设备发送数据包到远程目的设备，则需要借助路由器和路由。路由是确定到达目的之最佳路径的过程。连接到本地网段的路由器称为默认网关。":[19],"默认网关":[20],"默认网关是可以将流量路由到其他网络的网络设备。它是将流量从本地网络路由出去的路由器。":[20],"如果把一个网络比作一个房间，那么默认网关就好比是门口。如果要去另一个房间或网络，您就需要找到门口。":[20],"或者，不知道默认网关":[20],"pc":[20,21],"或计算机就好比是一个房间里不知道门口在哪的人。他们可以和房间或网络中的其他人交谈，但是如果他们不知道默认网关地址，或者如果没有默认网关，那么就没有出路。":[20],"图中列出了默认网关提供的功能。":[20],"使用默认网关":[21],"主机的路由表通常包括默认网关。主机通过动态主机配置协议":[21],"dhcp":[21],"动态接收默认网关":[21],"地址，或者通过手动配置。在图中，pc1":[21],"pc2":[21,28,51],"均配置了默认网关的":[21],"1。配置默认网关会在":[21],"的路由表中创建一个默认路由。默认路由是计算机尝试联系远程网络时所用的路由或路径。":[21],"默认路由来自默认网关配置，位于主机计算机的路由表中。pc1":[21],"都会使用默认路由将指向远程网络的所有流量发送到":[21],"r1。":[21],"主机路由表":[22],"在":[22,24],"windows":[22],"主机上，使用":[22],"route":[22,24,50,55],"print":[22],"netstat":[22],"r":[22],"命令可以显示主机路由表。这两个命令生成相同的输出。输出可能乍一看很晦涩，但是实际上相当容易理解。":[22],"输入":[22],"命令或等效的":[22],"命令，显示有关当前":[22],"网络连接的三个部分：":[22],"接口列表":[22],"列出主机上的介质访问控制":[22],"mac":[22],"地址和每个网络接口的已分配接口编号，包括以太网、wi":[22],"fi":[22],"和蓝牙适配器。":[22],"路由表":[22,29],"列出所有已知的":[22],"路由，包括直接连接、本地网络和本地默认路由。":[22],"路由器数据包转发决策":[23],"当一台主机发送数据包到另一台主机时，它将使用路由表来确定将数据包发送到哪里。如果目的主机位于远程网络，则数据包会转发到默认网关。":[23],"数据包到达默认网关（通常是路由器）时会发生什么情况？路由器会查看路由表来确定将数据包转发到哪里。":[23],"路由器的路由表存储下列信息：":[23],"直连路由":[23],"这些路由来自于活动的路由器接口。当接口配置了":[23],"地址并激活时，路由器会添加直连路由。路由器的每个接口均连接到一个不同的网段。":[23],"远程路由":[23],"这些路由来自连接到其他路由器的远程网络。通向这些网络的路由可以由网络管理员在本地路由器上手动配置，也可动态配置，后者的方法是启用本地路由器，使其与其他使用动态路由协议的路由器交换信息。":[23],"默认路由":[23],"与主机一样，如果路由表中没有通向目标网络的其他路由，路由器也会将默认路由作为最后选用网关。":[23],"该图用于确定路由器":[23],"r1":[23,24,26,27,28,49],"的直连网络和远程网络。":[23],"路由器路由表":[24],"cisco":[24,31,32,33,34,40,42,55,57],"ios":[24,32,33,36,39,40,42,55,57],"路由器上，show":[24],"命令可用于显示路由器的":[24],"路由表，如图所示。":[24],"除了为直连网络和远程网络提供路由信息，路由表还包括其他一些信息，比如路由获取方式、路由的可信度和等级、上次更新路由的时间以及到达请求的目的地所使用的接口。":[24],"当数据包到达路由器接口时，路由器会检查数据包报头，从而确定目的网络。如果目的网络与路由表中的某个路由匹配，路由器会使用路由表指定的信息转发数据包。如果有两个或多个路由均可到达同一个目的网络，则使用度量来决定应在路由表中显示的路由。":[24],"图中显示的是网络图中的":[24],"路由表。":[24],"路由表简介":[25],"不同于主机计算机的路由表，该路由表中没有用于确定路由器路由表所包含信息的列标题。学习路由表的每个条目中的不同项目的含义非常重要。":[25],"，观看":[25],"路由表简介。":[25],"直连路由表条目":[26],"为路由器接口配置":[26],"地址、子网掩码并激活时，将会自动创建以下两个路由表条目：":[26],"c":[26,28,40],"用于确定直连网络。为接口配置":[26],"地址并激活时，会自动创建直连网络。":[26],"l":[26,28],"表示这是本地接口。这是路由器接口的":[26],"图中所示为":[26],"上的直连网络":[26],"的路由表条目。配置":[26],"gigabitethernet":[26,49],"接口并激活时，这些条目会自动添加到路由表。单击每个加号可查看直连路由表条目的详细信息。":[26],"注意：ios":[26],"之前的版本中没有本地接口条目。":[26],"远程网络路由表条目":[27],"一个路由器通常配置有多个接口。路由表既储存直连网络信息，也储存远程网络信息。":[27],"图中所示为通向远程网络":[27],"路由。单击每个加号可查看直连路由表条目的详细信息。":[27],"下一跳地址":[28],"当要转发至远程网络的数据包到达路由器时，路由器会将目的网络与路由表中的路由进行匹配。如果找到匹配项，路由器会通过已确定的接口将数据包转发到下一跳地址。":[28],"请参考图":[28],"中的示例网络拓扑。假设":[28],"pc1":[28],"已发送了一个指向":[28],"网络的数据包。当数据包到达":[28],"的千兆接口时，r1":[28],"会将数据包的目的":[28],"地址与其路由表中的条目进行比较。图":[28],"显示了路由表。根据路由内容，r1":[28],"会通过其":[28],"serial":[28,49],"接口将数据包转发到下一跳地址":[28],"226。":[28],"注意路由来源为":[28],"的直连网络没有下一跳地址。这是因为路由器可以使用指定的接口直接将数据包转发至这些网络上的主机。":[28],"还必须要知道，路由器不能转发目的网络与路由表中的路由不匹配的数据包。如果路由表中没有代表目的网络的路由，会丢弃数据包（即不转发）。但是，正如主机可以使用默认网关将数据包转发到未知目的地址，路由器也可以包含默认路由，以创建最后选用网关。可以手动配置或动态获取默认路由。":[28],"解释":[29],"主机和路由器通过查询各自的路由表做出数据包路由决策。":[29],"以查看":[29],"路由表的详细解释。":[29],"识别路由器路由表条目的要素":[30],"路由器是计算机":[31],"有多种基础设施路由器。事实上，思科路由器可以满足许多不同类型的企业和网络的需求：":[31],"分支机构":[31],"远程工作人员、小型企业和中型分支机构站点。包括思科第二代集成多业务路由器":[31],"isr":[31,34],"wan":[31,36,49,50],"大型企业、机构和公司。包括":[31],"catalyst":[31,55],"系列交换机和思科聚合多业务路由器":[31],"asr":[31],"服务供应商":[31],"大型服务供应商。包括":[31],"asr、cisco":[31],"crs":[31],"运营商级路由系统和":[31],"系列路由器。":[31],"ccna":[31],"认证的重点是分支机构系列路由器。图中显示了":[31],"1900、2900":[31],"第二代集成多业务路由器。":[31],"不管它们的功能、大小或复杂性如何，所有路由器型号实质上都是计算机。和计算机、平板电脑和智能设备一样，路由器也需要：":[31],"中央处理器":[31],"cpu":[31,32,33,40],"操作系统":[31],"os":[31,32],"内存包括随机访问存储器":[31],"ram":[31,33,39,40,50],"、只读存储器":[31],"rom":[31,33,40],"、非易失性随机访问存储器":[31],"nvram":[31,33,40],"和闪存。":[31],"路由器":[32],"和操作系统":[32],"与所有计算机、平板电脑、游戏机和智能设备一样，思科设备需要":[32],"来执行操作系统指令，如系统初始化、路由功能和交换功能。":[32],"图中突出显示的部分是一台连接了散热器的":[32],"路由器的":[32],"cpu。散热器有助于驱散":[32],"产生的热量。":[32],"需要":[32],"来提供路由和交换功能。思科互联网络操作系统":[32],"是用于多数思科设备的系统软件，无论这些设备的大小和类型如何。它用于路由器、lan":[32],"交换机、小型无线接入点、具有几十个接口的大型路由器以及许多其他设备。":[32],"路由器存储器":[33],"路由器可使用易失性或非易失性存储器。易失性存储器需要持续的电源才能保留其中的信息。当关闭或重新启动路由器时，内容将被擦除并丢失。非易失性存储器在设备重启时也能保留信息。":[33],"具体来说，思科路由器使用四种存储器：":[33],"这是思科路由器中使用的易失性存储器，用于存储":[33],"执行的应用程序、进程和数据。思科路由器使用一种快速":[33],"ram，称为同步动态随机访问存储器":[33],"sdram":[33],"。单击图中的":[33],"以查看详细信息。":[33],"这种非易失性存储器用于存储重要的操作指令和有限的":[33],"ios。具体来说，rom":[33],"是嵌入在路由器内的集成电路上的固件，只有思科可以改变。单击图中的":[33],"这种非易失性存储器可用作启动配置文件":[33],"startup":[33,50],"config":[33,50],"的永久性存储器。":[33],"闪存":[33],"这种非易失性计算机存储器可用作":[33],"和其他系统相关文件的永久性存储器，比如日志文件、语音配置文件、html":[33],"文件、备份配置及其他内容。当路由器重启时，ios":[33],"从闪存复制到":[33],"中。":[33],"所有路由器平台都有默认设置和组件。例如，cisco":[33],"配有":[33],"mb":[33],"sdram，但是可升级到":[33],"gb。cisco":[33],"路由器还配有":[33],"闪存，但是不能使用两个外部紧凑式闪存插槽进行升级。每个插槽均可支持高速存储卡，可升级至":[33],"4gb。单击此处了解有关":[33],"集成多业务路由器的详细信息。":[33],"路由器内部构造":[34],"尽管路由器类型和型号多种多样，但每种路由器都具有相同的通用硬件组件。":[34],"第一代":[34],"的内部配置。单击组件查看组件概述。该图也显示了路由器中的其他组件，如电源、冷却风扇、隔热屏和高级集成模块":[34],"aim":[34],"，这些不在本章的介绍范围之内。":[34],"注意：网络专业人员应熟知并了解路由器的主要内部组件的功能，而不是这些组件在具体路由器中的确切位置。根据型号的不同，这些组件在路由器内部的位置有所差异。":[34],"连接路由器":[35],"思科设备、路由器和交换机通常可以与多台设备互联。因此，这些设备具有多种端口和接口，可以用来连接设备。例如，cisco":[35],"路由器背板包括图中描述的连接和端口。单击每个突出显示的区域可查看更多信息。":[35],"与许多网络连接设备一样，思科设备使用发光二极管":[35],"led":[35],"指示灯来提供状态信息。接口上的":[35],"会指示对应接口的活动情况。如果接口为活动状态而且连接正确，但":[35],"不亮，则表示该接口可能存在故障。如果接口极其繁忙，则其":[35],"会一直亮起。":[35],"lan":[36,49,50,51,53,57],"接口":[36,49],"思科路由器上的连接可分为两类：带内路由器接口和管理端口。单击图":[36],"中突出显示的区域可查看更多信息。":[36],"与思科交换机类似，有多种方法可以访问思科路由器上的":[36],"cli":[36,48],"环境中的用户":[36],"exec":[36,47],"模式。最常用的方法包括：":[36],"控制台":[36],"这是一种物理管理端口，可通过该端口对思科设备进行带外访问。带外访问是指通过仅用于设备维护的专用管理通道进行访问。":[36],"安全外壳":[36],"ssh":[36,52],"是使用虚拟接口通过网络远程建立安全":[36],"连接的方法。不同于控制台连接，ssh":[36],"连接需要设备上具有有效的网络服务，包括配置了地址的有效接口。":[36],"telnet":[36,52],"使用虚拟接口通过网络远程建立":[36],"会话，这种方法并不安全。不同于":[36],"ssh，telnet":[36],"不提供经过加密的安全连接。用户身份验证、密码和命令通过网络以明文形式发送。":[36],"注意：某些设备，比如路由器，还可以支持传统辅助端口，这种辅助端口可用于通过调制解调器远程建立":[36],"会话。类似于控制台连接，aux":[36],"端口也是带外连接，且不需要配置或提供网络服务。":[36],"要求带内网络连接，这意味着管理员必须通过其中一个":[36],"接口访问路由器。单击图":[36],"带内接口接收和转发":[36],"数据包。路由器上配置的每个活动接口都是不同":[36],"网络上的一员或一台主机。每个接口必须配置一个":[36],"地址以及对应网络的子网掩码。cisco":[36],"不允许同一路由器上的两个活动接口同属一个网络。":[36],"确定路由器组件":[37],"packet":[38,48,53,54,55,57],"tracer":[38,48,53,54,55,57],"探索网络互联设备":[38],"在本练习中，您将探索网络互联设备上不同的可用选项。还将要求您确定连接多个设备时可以提供必要连接的选项。最后，您将添加正确模块并连接设备。":[38],"探索网络互联设备的说明":[38],"pka":[38,48,53,54,57],"bootset":[39],"文件":[39],"思科路由器和交换机都会在重启时将":[39],"映像和启动配置文件加载到":[39],"中，如图所示。":[39],"当网络管理员配置设备时，运行配置文件即被修改。更改运行配置文件时，此文件将作为启动配置文件保存到":[39],"nvram，以防路由器重新启动或断电。":[39],"路由器启动过程":[40,41,44],"启动过程分为三个主要阶段。如图":[40],"所示，这三个阶段为：":[40],"执行":[40],"post":[40],"并加载引导程序。":[40],"查找并加载":[40],"软件。":[40],"查找并加载启动配置文件，或进入设置模式。":[40],"和加载引导程序（图":[40],"2）":[40],"在加电自检":[40],"过程中，路由器会通过":[40],"对若干硬件组件进行诊断，包括":[40],"cpu、ram":[40],"nvram。post":[40],"完成后，引导程序将从":[40],"复制到":[40],"ram。引导程序的主要任务是查找":[40],"并将其加载到":[40],"ram。":[40],"注意：此时，如果有控制台与此路由器连接，您会看到屏幕上开始出现输出内容。":[40],"ios（图":[40],"3）":[40],"通常存储在闪存中，由":[40],"将其复制到":[40],"进行执行。如果闪存中没有找到":[40],"映像，则路由器可以使用简单文件传输协议":[40],"tftp":[40],"服务器进行查找。如果找不到完整的":[40],"映像，有限的":[40],"将复制到":[40],"ram，这可用于诊断问题并将完整的":[40],"传输到闪存中。":[40],"查找并加载配置文件（图":[40],"4）":[40],"引导程序将启动配置文件从":[40],"中。该文件随即成为运行配置。如果":[40],"中不存在启动配置文件，则路由器可能会配置为搜索":[40],"服务器。如果未找到":[40],"服务器，则路由器显示设置模式提示。":[40],"注意：本课程不使用设置模式配置路由器。当提示进入设置模式时，请始终回答":[40],"no。如果回答":[40],"yes":[40],"并进入设置模式，可随时按":[40],"ctrl":[40],"终止设置过程。":[40],"，观看路由器启动过程的演示。":[41],"show":[42,43,45,50,53,55],"version":[42,43],"输出":[42,55],"如图所示，show":[42],"命令会显示路由器当前所运行的":[42],"软件的版本信息、引导程序版本信息以及硬件配置信息（包括系统存储器大小）。":[42],"命令":[43],"，以观看":[43],"命令的解释。":[43],"实验":[45,56],"探索路由器的物理特征":[45],"在本实验中，您将完成以下目标：":[45,56],"部分：检查路由器外部特征":[45],"部分：使用":[45],"命令检查路由器内部特征":[45],"基本交换机配置步骤":[46],"思科路由器和思科交换机有许多相似之处。它们支持类似的操作系统、类似的命令结构和许多相同的命令。此外，在网络中实施时，两个设备采用相同的初始配置步骤。":[46],"在开始配置路由器之前，请查看图":[46],"中列出的初始交换机配置任务。图":[46],"显示了一个示例配置。":[46],"基本路由器配置步骤":[47],"与配置交换机相似，配置路由器的初始设置时要完成图":[47],"中列出的任务。":[47],"至":[47],"提供了在路由器上配置这些任务的示例。在图":[47],"中，为路由器分配了一个主机名。在图":[47],"中，特权":[47],"模式、用户":[47],"模式和远程访问线路使用密码进行保护，并且配置文件中的所有密码均已加密。图":[47],"中配置了提供约定通知。最后，图":[47],"中保存了配置。":[47],"使用图":[47,49,52],"中的语法检查器练习这些配置步骤。":[47],"配置初始路由器设置":[48],"在本练习中，您将执行基本的路由器配置。您将使用加密密码和明文密码来保护对":[48],"和控制台端口的访问。您还将为登录到该路由器的用户配置消息。这些标语也用来警示未授权用户访问是被禁止的。最后，您将验证并保存运行配置。":[48],"配置初始路由器设置的说明":[48],"配置路由器接口":[49],"要使路由器可访问，必须配置带内路由器接口。思科路由器上有许多不同类型的接口。此示例中，cisco":[49],"路由器配备以下接口：":[49],"两个千兆以太网接口":[49],"g0":[49],"由两个接口组成的一个串行":[49],"接口卡":[49],"wic":[49],"s0":[49],"注意：单击此处了解有关接口缩写和编号的详细信息。":[49],"中列出了用于配置路由器接口的任务。注意它们与在交换机上配置管理":[49],"svi":[49,52],"的相似之处。":[49],"尽管不必要，仍建议为每个接口配置说明文字，以帮助记录网络信息。说明文字最长不能超过":[49],"个字符。在生产网络中，在说明文字中提供接口所连接的网络类型以及此网络中是否还有其他路由器等信息的做法在故障排除中很实用。如果接口连接到":[49],"isp":[49],"或服务运营商，输入第三方连接信息和联系信息的做法也很实用。":[49],"使用":[49,55],"no":[49],"shutdown":[49],"命令可激活接口，类似于启动接口。接口还必须连接到另一台设备（交换机或路由器），才能使物理层处于活动状态。":[49],"显示了连接":[49],"接口的配置。":[49],"中的语法检查器练习配置":[49],"检验接口配置":[50],"有多条命令可用于检验接口配置。其中最常用的是":[50],"interface":[50,58],"brief":[50],"命令。生成的输出显示所有接口、其":[50],"地址和当前状态。已配置和连接的接口的状态和协议均会显示":[50],"up":[50],"。显示任何其他内容均表示配置或布线出现问题。":[50],"您可以使用":[50],"命令验证接口的连通性。思科路由器发送五个连续的":[50],"ping，并测量最小、平均和最大往返时间。感叹号用于验证连通性。":[50],"显示了":[50],"命令的输出，这表示":[50],"接口和":[50],"链路均已激活并可以运行。注意，ping":[50],"命令生成的五个感叹号可以验证到":[50],"r2":[50],"的连通性。":[50],"其他接口验证命令包括：":[50],"显示存储在":[50],"中的":[50],"路由表的内容。":[50],"interfaces":[50],"显示设备上所有接口的统计信息。":[50],"显示路由器上所有接口的":[50],"统计信息。":[50],"显示的是":[50],"命令的输出。注意三个直连网络条目及其本地接口":[50],"记住使用":[50],"copy":[50],"running":[50],"命令来保存配置。":[50],"主机的默认网关":[51],"对于通过网络通信的终端设备，必须配置正确的":[51],"地址信息，包括默认网关地址。当主机要将数据包发送到另一个网络设备时，才会使用默认网关。默认网关地址通常是连接主机本地网络的路由器接口地址。主机设备的":[51],"地址和路由器接口地址必须位于同一网络。":[51],"和图":[51],"中的网络拓扑由互联两个单独的":[51],"的路由器组成。g0":[51],"连接到网络":[51],"0，g0":[51],"0。每台主机设备均配置有相应的默认网关地址。":[51],"在图":[51],"中，pc1":[51],"将数据包发送到":[51],"pc2。在此示例中，未使用默认网关。相反，pc1":[51],"将":[51],"地址指定给数据包，然后通过交换机将该数据包直接转发给":[51],"pc2。":[51],"pc3。在此示例中，pc1":[51],"pc3":[51],"地址指定给数据包，但是随后将该数据包转发给路由器。路由器接受数据包，访问其路由表，进而根据目的地址确定相应的出接口，然后将数据包转发出相应接口，以到达":[51],"pc3。":[51],"交换机的默认网关":[52],"一般来说，连接客户端计算机的工作组交换机是第":[52],"层设备。因此，第":[52],"层交换机不需要使用":[52],"地址就能正常工作。但是，如果您想通过多个网络连接到交换机并进行管理，则需要配置":[52],"地址、子网掩码和默认网关地址。":[52],"在希望通过本地网络之外的方式通信的所有设备上，一般都会配置默认网关地址。换句话说，若要使用":[52],"从其他网络远程访问交换机，交换机必须具有配置了":[52],"地址、子网掩码和默认网关地址的":[52],"svi。如果从本地网络中的主机访问交换机，则不需要使用默认网关":[52],"要为交换机配置默认网关，请使用":[52],"default":[52],"gateway":[52],"全局配置命令。配置的":[52],"地址是相连交换机的路由器接口的":[52],"显示了管理员正在建立到另一个网络上的交换机":[52],"s1":[52],"的远程连接。必须使用默认网关配置":[52],"s1，s1":[52],"才能够应答并建立与管理主机的":[52],"连接。":[52],"常见误解是，对于来源为与交换机相连的主机且目的地为远程网络中的主机的数据包，交换机会使用自身配置的默认网关地址来确定转发数据包的目的地。实际上，ip":[52],"地址和默认网关信息仅用于来源为交换机的数据包。来自与交换机相连的主机计算机的数据包必须在主机计算机操作系统上配置默认网关地址。":[52],"中的语法检查器练习在交换机上配置默认网关。":[52],"将路由器连接到":[53],"在本练习中，您将使用各种":[53],"命令显示路由器的当前状态。然后使用地址分配表配置路由器的以太网接口。最后，您将使用各种命令来检验并测试您的配置。":[53],"的说明":[53],"排除默认网关故障":[54],"对于用来进行多个网络间通信的设备，必须为其配置":[54],"地址、子网掩码和默认网关。在主机想向另一网络中的设备发送数据包时，需要使用默认网关。默认网关地址通常是与主机连接的本地网络中的路由器接口地址。在本练习中，您将完成网络的文档编制。然后您将通过测试端到端连接和故障排除问题来验证网络文档。您将使用的故障排除方法包括以下步骤：":[54],"步：验证网络文档，并使用测试来查明问题。":[54],"步：为查明的问题确定一个适当的解决方案。":[54],"步：实施解决方案。":[54],"步：进行测试以验证问题是否已解决。":[54],"步：记录解决方案。":[54],"排除默认网关故障的说明":[54],"您能否看懂该映射？":[55],"注意：建议学生两个一组完成此练习，但是，如果愿意，也可以单独完成。":[55],"教师将为您展示路由器的":[55],"命令生成的输出。请利用此路由信息在":[55],"中构建拓扑模型。":[55],"您的拓扑模型中至少应包含以下内容：":[55],"台":[55],"交换机":[55],"系列路由器，使用一个":[55],"hwic":[55],"4esw":[55],"交换端口模块化卡和":[55],"版本或更高版本":[55],"pc（可以是服务器、普通":[55],"pc、笔记本电脑等）":[55],"中的备注工具指示路由器接口的地址以及您为模型选择的终端设备的可能地址。标记通过":[55],"文件中的":[55],"路由表信息确定的所有终端设备、端口和地址。将您的工作保存为硬拷贝或软拷贝，以便在课堂上进行分享。":[55],"您能否看懂该映射？说明":[55],"构建交换机和路由器网络":[56],"部分：建立拓扑并初始化设备":[56],"部分：配置设备并检验连接":[56],"部分：显示设备信息":[56],"综合技能练习":[57],"您的网络管理员对您担任":[57],"技术人员所做的工作印象深刻。她希望您现在展示一下配置路由器连接两个":[57],"的能力。您的任务包括使用":[57],"配置路由器和交换机的基本设置。然后，您需要通过测试端到端连接来检验您的配置和现有设备上的配置。":[57],"综合技能练习说明":[57],"层，提供能够让终端设备跨整个网络交换数据的服务。为了实现这种端到端传输，网络层使用了四个基本过程：终端设备的":[58],"编址、封装、路由和解封。":[58],"主要基于":[58],"ipv4，ipv4":[58],"仍然是使用最广泛的网络层协议。ipv4":[58],"数据包包含":[58],"报头和负载。但是，ipv4":[58],"的唯一公有":[58],"地址数量有限。这促使了":[58],"使用简化的报头，比":[58],"具有更多优势，例如更高的路由效率、简化的扩展报头和单个流处理能力。此外，ipv6":[58],"位。这显著增加了可用的":[58],"地址数量。":[58],"除了分层编址外，网络层也负责路由。":[58],"主机需要使用本地路由表才能确保数据包转发到正确的目的网络。主机的本地路由表通常包含直连路由、本地网络路由和本地默认路由。本地默认路由是到默认网关的路由。":[58],"默认网关是连接本地网络的路由器接口的":[58],"地址。当主机需要将数据包转发到与此主机不在同一网络的目的地址时，会将数据包发送到默认网关进行进一步处理。":[58],"当路由器（例如默认网关）收到数据包时，它会检查目的":[58],"地址以确定目的网络。路由器的路由表存储了有关":[58],"网络的直连路由和远程路由的信息。如果路由器的路由表中存在指向目的网络的条目，路由器会转发数据包。如果不存在匹配的路由条目，若已配置了默认路由，路由器可能会将数据包转发到自己的默认路由，否则它会丢弃数据包。":[58],"可以在每台路由器上手动配置路由表条目来提供静态路由，路由器相互之间也可以使用路由协议动态交换路由信息。":[58],"为了能够连接路由器，必须配置路由器接口。要启用具体接口，请使用":[58],"type":[58],"and":[58],"number":[58],"全局配置模式命令进入接口配置模式。":[58]}}