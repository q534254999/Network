<!DOCTYPE html>
<html class="loading" dir="ltr" lang="zh-Hans">
  <head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>9.2.2.4 TCP 流量控制 - 窗口大小和确认</title>
    <!-- Content -->
    <link rel="stylesheet" type="text/css" href="../../common-ext/styles/page.css"/>
    <script type="text/javascript" src="../../common-ext/scripts/jquery-2.1.0.min.js"></script>
    <script type="text/javascript" src="../../common-ext/scripts/permission.js"></script>
    <script type="text/javascript" src="../../common-ext/scripts/page.js"></script>
    <script type="text/javascript" src="media/override.js"></script>
    <script>
      var media_transcript_file = "media_9.2.2.4_longdesc.txt";
    </script>
  </head>
  <body>
    <div id="text-container" role="main">
      <div id="text">
        <h1>TCP 流量控制 - 窗口大小和确认</h1>
        <div>
          <p>TCP 同时提供流量控制机制，即目的主机能够可靠地接受并处理的数据量。流量控制可以调整给定会话中源和目的地之间的数据流速，有助于保持 TCP 传输的可靠性。为此，TCP 报头包括一个称为“窗口大小”的 16 位字段。</p>
          <p></p>
          <p>图中显示了一个窗口大小和确认的示例。窗口大小是 TCP 会话的目的设备一次可以接受和处理的字节数。在本例中，PC B 用于 TCP 会话的初始窗口大小为 10,000 字节。从第 1 个字节开始，字节数为 1，PC A 在不收到确认的前提下可以发送的最后一个字节为 10,000。这就是 PC A 的发送窗口。每个 TCP 数据段均包含窗口大小，那样目的设备可以根据缓冲区的可用性随时修改窗口大小。</p>
          <p></p>
          <p>
            <b>注意</b>：如图所示，在每个 TCP 数据段内，源主机正在传输 1,460 字节的数据。我们将此称为 MSS（最大数据段大小）MSS 的详细信息请参阅章节附录。</p>
          <p></p>
          <p>初始窗口大小在三次握手期间建立 TCP 会话时确定。源设备必须根据目的设备的窗口大小限制发送到目的设备的字节数。只有源设备收到字节数已接收的确认之后，才能继续发送更多会话数据。通常情况下，目的设备不会等待其窗口大小的所有字节接收后才以确认应答。接收和处理字节时，目的设备就会发送确认，以告知源设备它可以继续发送更多字节。 </p>
          <p></p>
          <p>通常情况下，PC B 不会等待所有 10,000 字节都接收后才发送确认。这就意味着 PC A 可以在收到 PC B 的确认时调整其发送窗口。如图所示，当 PC A 收到确认号为 2,921 的确认消息时，PC A 的发送窗口将另外增加 10,000 字节（PC B 的当前窗口大小），增加至 12,920。现在只要 PC A 发送不超出其新的发送窗口 12,920 的字节数，它就能够向 PC B 另外发送 10,000 字节。  </p>
          <p></p>
          <p>目的设备在处理接收的字节并不断调整源设备的发送窗口大小时发送确认的过程被称为滑动窗口。 </p>
          <p></p>
          <p>如果目的设备缓冲区空间的可用性减小，它可以缩减窗口大小，通知源设备减少发送的字节数，而不需要接收确认。</p>
          <p></p>
          <p>
            <b>注意</b>：设备通常使用滑动窗口协议。使用滑动窗口时，接收方不会等待达到其窗口大小中的字节数后才发送确认。接收方通常在每收到两个数据段之后发送确认。在确认之前收到的数据段的数量可能有所不同。滑动窗口的优势在于，只要接收方确认之前的数据段，就可以让发送方持续传输数据段。滑动窗口的详细信息不在本课程的讨论范围之内。</p>
          <p></p>
        </div>
      </div>
      <div id="text-handle" title="调整大小" role="button"></div>
    </div>
    <div id="media-container" role="complementary">
      <iframe id="media" title="interactive graphic" aria-label="interactive graphic" aria-describedby="media-description"></iframe>
      <div id="media-description">Figures shows a window size example. PC B has specified that the window size is 10,000 and the maximum segment size is 1460. PC A sends the first 1460 bytes and then the send 1460 bytes. PC B sends an ACK 2921 and confirms window size is still 10,000. PC A sends another 1460 bytes. PC B send an ACK 4381 and confirms window size is still 10,000.</div>
    </div>
    <div id="login">在访问该课程之前，请登录 <a href="http://netacad.com">netacad.com</a>。</div>
  </body>
</html>
